# å‘½ä»¤è¡Œå‚æ•°

å‘½ä»¤è¡Œå‚æ•°çš„ä»‹ç»ä¼šåˆ†ä¸ºåŸºæœ¬å‚æ•°ï¼ŒåŸå­å‚æ•°ã€é›†æˆå‚æ•°å’Œç‰¹å®šæ¨¡å‹å‚æ•°ã€‚å‘½ä»¤è¡Œæœ€ç»ˆä½¿ç”¨çš„å‚æ•°åˆ—è¡¨ä¸ºé›†æˆå‚æ•°ã€‚é›†æˆå‚æ•°ç»§æ‰¿è‡ªåŸºæœ¬å‚æ•°å’Œä¸€äº›åŸå­å‚æ•°ã€‚ç‰¹å®šæ¨¡å‹å‚æ•°æ˜¯é’ˆå¯¹äºå…·ä½“æ¨¡å‹çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡`--model_kwargs'`æˆ–è€…ç¯å¢ƒå˜é‡è¿›è¡Œè®¾ç½®ã€‚Megatron-SWIFTå‘½ä»¤è¡Œå‚æ•°ä»‹ç»å¯ä»¥åœ¨[Megatron-SWIFTè®­ç»ƒæ–‡æ¡£](./Megatron-SWIFTè®­ç»ƒ.md)ä¸­æ‰¾åˆ°ã€‚

æç¤ºï¼š
- å‘½ä»¤è¡Œä¼ å…¥listä½¿ç”¨ç©ºæ ¼éš”å¼€å³å¯ã€‚ä¾‹å¦‚ï¼š`--dataset <dataset_path1> <dataset_path2>`ã€‚
- å‘½ä»¤è¡Œä¼ å…¥dictä½¿ç”¨jsonã€‚ä¾‹å¦‚ï¼š`--model_kwargs '{"fps_max_frames": 12}'`
- å¸¦ğŸ”¥çš„å‚æ•°ä¸ºé‡è¦å‚æ•°ï¼Œåˆšç†Ÿæ‚‰ms-swiftçš„ç”¨æˆ·å¯ä»¥å…ˆå…³æ³¨è¿™äº›å‘½ä»¤è¡Œå‚æ•°

## åŸºæœ¬å‚æ•°

- ğŸ”¥tuner_backend: å¯é€‰ä¸º'peft'ï¼Œ'unsloth'ã€‚é»˜è®¤ä¸º'peft'
- ğŸ”¥train_type: å¯é€‰ä¸º: 'lora'ã€'full'ã€'longlora'ã€'adalora'ã€'llamapro'ã€'adapter'ã€'vera'ã€'boft'ã€'fourierft'ã€'reft'ã€‚é»˜è®¤ä¸º'lora'
- ğŸ”¥adapters: ç”¨äºæŒ‡å®šadapterçš„id/pathçš„listï¼Œé»˜è®¤ä¸º`[]`
- external_plugins: å¤–éƒ¨plugin pyæ–‡ä»¶åˆ—è¡¨ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«æ³¨å†Œè¿›pluginæ¨¡å—ä¸­ï¼Œä¾‹å­è¯·å‚è§[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/train/grpo/run_external_rm.sh)
- seed: é»˜è®¤ä¸º42
- model_kwargs: ç‰¹å®šæ¨¡å‹å¯ä¼ å…¥çš„é¢å¤–å‚æ•°ï¼Œè¯¥å‚æ•°åˆ—è¡¨ä¼šåœ¨è®­ç»ƒæ¨ç†æ—¶æ‰“å°æ—¥å¿—è¿›è¡Œæç¤ºã€‚ä¾‹å¦‚`--model_kwargs '{"fps_max_frames": 12}'`
- load_args: å½“æŒ‡å®š`--resume_from_checkpoint`ã€`--model`ã€`--adapters`ä¼šè¯»å–ä¿å­˜æ–‡ä»¶ä¸­çš„`args.json`ï¼Œå°†é»˜è®¤ä¸ºNoneçš„`åŸºæœ¬å‚æ•°`ï¼ˆé™¤å»æ•°æ®å‚æ•°å’Œç”Ÿæˆå‚æ•°ï¼‰è¿›è¡Œèµ‹å€¼ï¼ˆå¯é€šè¿‡æ‰‹åŠ¨ä¼ å…¥è¿›è¡Œè¦†ç›–ï¼‰ã€‚æ¨ç†å’Œå¯¼å‡ºæ—¶é»˜è®¤ä¸ºTrueï¼Œè®­ç»ƒæ—¶é»˜è®¤ä¸ºFalse
- load_data_args: å¦‚æœå°†è¯¥å‚æ•°è®¾ç½®ä¸ºTrueï¼Œåˆ™ä¼šé¢å¤–è¯»å–`args.json`ä¸­çš„æ•°æ®å‚æ•°ã€‚é»˜è®¤ä¸ºFalse
- use_hf: æ§åˆ¶æ¨¡å‹ä¸‹è½½ã€æ•°æ®é›†ä¸‹è½½ã€æ¨¡å‹æ¨é€ä½¿ç”¨ModelScopeè¿˜æ˜¯HuggingFaceã€‚é»˜è®¤ä¸ºFalseï¼Œä½¿ç”¨ModelScope
- hub_token: hub token. modelscopeçš„hub tokenå¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/my/myaccesstoken)
- custom_register_path: è‡ªå®šä¹‰æ¨¡å‹ã€å¯¹è¯æ¨¡æ¿å’Œæ•°æ®é›†æ³¨å†Œçš„`.py`æ–‡ä»¶è·¯å¾„çš„listã€‚é»˜è®¤ä¸º`[]`

### æ¨¡å‹å‚æ•°
- ğŸ”¥model: æ¨¡å‹idæˆ–æ¨¡å‹æœ¬åœ°è·¯å¾„ã€‚å¦‚æœæ˜¯è‡ªå®šä¹‰æ¨¡å‹è¯·é…åˆ`model_type`å’Œ`template`ä½¿ç”¨ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ[è‡ªå®šä¹‰æ¨¡å‹](../Customization/è‡ªå®šä¹‰æ¨¡å‹.md)
- model_type: æ¨¡å‹ç±»å‹ã€‚ç›¸åŒçš„æ¨¡å‹æ¶æ„ã€templateã€æ¨¡å‹åŠ è½½è¿‡ç¨‹è¢«å®šä¹‰ä¸ºä¸€ä¸ªmodel_typeã€‚é»˜è®¤ä¸ºNoneï¼Œæ ¹æ®`--model`çš„åç¼€å’Œconfig.jsonä¸­çš„architectureså±æ€§è¿›è¡Œè‡ªåŠ¨é€‰æ‹©
- model_revision: æ¨¡å‹ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸ºNone
- task_type: é»˜è®¤ä¸º'causal_lm'ï¼ˆè‹¥è®¾ç½®äº†`--num_labels`ï¼Œè¯¥å‚æ•°ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸º'seq_cls'ï¼‰ã€‚å¯é€‰ä¸º'causal_lm'ã€'seq_cls'ã€‚seq_clsçš„ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/train/seq_cls)
- ğŸ”¥torch_dtype: æ¨¡å‹æƒé‡çš„æ•°æ®ç±»å‹ï¼Œæ”¯æŒ`float16`,`bfloat16`,`float32`ã€‚é»˜è®¤ä¸ºNoneï¼Œä»config.jsonæ–‡ä»¶ä¸­è¯»å–
- attn_impl: attentionç±»å‹ï¼Œå¯é€‰é¡¹ä¸º`flash_attn`, `sdpa`, `eager`ã€‚é»˜è®¤ä½¿ç”¨sdpaï¼Œè‹¥ä¸æ”¯æŒåˆ™ä½¿ç”¨eagerã€‚
  - æ³¨æ„ï¼šè¿™ä¸‰ç§å®ç°å¹¶ä¸ä¸€å®šéƒ½æ”¯æŒï¼Œè¿™å–å†³äºå¯¹åº”æ¨¡å‹çš„æ”¯æŒæƒ…å†µã€‚
- num_labels: åˆ†ç±»æ¨¡å‹éœ€è¦æŒ‡å®šè¯¥å‚æ•°ã€‚ä»£è¡¨æ ‡ç­¾æ•°é‡ï¼Œé»˜è®¤ä¸ºNone
- rope_scaling: ropeç±»å‹ï¼Œæ”¯æŒ`linear`å’Œ`dynamic`ï¼Œè¯·é…åˆ`max_length`å…±åŒä½¿ç”¨ã€‚é»˜è®¤ä¸ºNone
- device_map: æ¨¡å‹ä½¿ç”¨çš„device_mapé…ç½®ï¼Œä¾‹å¦‚ï¼š'auto'ã€'cpu'ã€jsonå­—ç¬¦ä¸²ã€jsonæ–‡ä»¶è·¯å¾„ã€‚é»˜è®¤ä¸ºNoneï¼Œæ ¹æ®è®¾å¤‡å’Œåˆ†å¸ƒå¼è®­ç»ƒæƒ…å†µè‡ªåŠ¨è®¾ç½®
- max_memory: device_mapè®¾ç½®ä¸º'auto'æˆ–è€…'sequential'æ—¶ï¼Œä¼šæ ¹æ®max_memoryè¿›è¡Œæ¨¡å‹æƒé‡çš„deviceåˆ†é…ï¼Œä¾‹å¦‚ï¼š`--max_memory '{0: "20GB", 1: "20GB"}'`ã€‚é»˜è®¤ä¸ºNone
- local_repo_path: éƒ¨åˆ†æ¨¡å‹åœ¨åŠ è½½æ—¶ä¾èµ–äºgithub repoã€‚ä¸ºäº†é¿å…`git clone`æ—¶é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°repoã€‚è¯¥å‚æ•°éœ€è¦ä¼ å…¥æœ¬åœ°repoçš„è·¯å¾„, é»˜è®¤ä¸º`None`

### æ•°æ®å‚æ•°
- ğŸ”¥dataset: æ•°æ®é›†idæˆ–è·¯å¾„çš„listã€‚é»˜è®¤ä¸º`[]`ã€‚æ¯ä¸ªæ•°æ®é›†çš„ä¼ å…¥æ ¼å¼ä¸ºï¼š`æ•°æ®é›†id or æ•°æ®é›†è·¯å¾„:å­æ•°æ®é›†#é‡‡æ ·æ•°é‡`ï¼Œå…¶ä¸­å­æ•°æ®é›†å’Œå–æ ·æ•°æ®å¯é€‰ã€‚æœ¬åœ°æ•°æ®é›†æ”¯æŒjsonlã€csvã€jsonã€æ–‡ä»¶å¤¹ç­‰ã€‚å¼€æºæ•°æ®é›†å¯ä»¥é€šè¿‡git cloneåˆ°æœ¬åœ°å¹¶å°†æ–‡ä»¶å¤¹ä¼ å…¥è€Œç¦»çº¿ä½¿ç”¨ã€‚è‡ªå®šä¹‰æ•°æ®é›†æ ¼å¼å¯ä»¥å‚è€ƒ[è‡ªå®šä¹‰æ•°æ®é›†](../Customization/è‡ªå®šä¹‰æ•°æ®é›†.md)
  - å­æ•°æ®é›†: è¯¥å‚æ•°åªæœ‰å½“datasetä¸ºIDæˆ–è€…æ–‡ä»¶å¤¹æ—¶ç”Ÿæ•ˆã€‚è‹¥æ³¨å†Œæ—¶æŒ‡å®šäº†subsetsï¼Œä¸”åªæœ‰ä¸€ä¸ªå­æ•°æ®é›†ï¼Œåˆ™é»˜è®¤é€‰æ‹©æ³¨å†Œæ—¶æŒ‡å®šçš„å­æ•°æ®é›†ï¼Œå¦åˆ™é»˜è®¤ä¸º'default'ã€‚ä½ å¯ä»¥ä½¿ç”¨`/`æ¥é€‰æ‹©å¤šä¸ªå­æ•°æ®é›†ï¼Œä¾‹å¦‚ï¼š`<dataset_id>:subset1/subset2`ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨'all'æ¥é€‰æ‹©æ‰€æœ‰çš„å­æ•°æ®é›†ï¼Œä¾‹å¦‚ï¼š`<dataset_id>:all`
  - é‡‡æ ·æ•°é‡: é»˜è®¤ä½¿ç”¨å®Œæ•´çš„æ•°æ®é›†ã€‚è‹¥é‡‡æ ·æ•°å°‘äºæ•°æ®æ ·æœ¬æ€»æ•°ï¼Œåˆ™è¿›è¡Œéšæœºé€‰æ‹©ï¼ˆä¸é‡å¤é‡‡æ ·ï¼‰ã€‚è‹¥é‡‡æ ·æ•°é«˜äºæ•°æ®æ ·æœ¬æ€»æ•°ï¼Œåˆ™åªé¢å¤–éšæœºé‡‡æ ·`é‡‡æ ·æ•°%æ•°æ®æ ·æœ¬æ€»æ•°`çš„æ ·æœ¬ï¼Œæ•°æ®æ ·æœ¬é‡å¤é‡‡æ ·`é‡‡æ ·æ•°//æ•°æ®æ ·æœ¬æ€»æ•°`æ¬¡
- ğŸ”¥val_dataset: éªŒè¯é›†idæˆ–è·¯å¾„çš„listã€‚é»˜è®¤ä¸º`[]`
- ğŸ”¥split_dataset_ratio: ä¸æŒ‡å®šval_datasetæ—¶å¦‚ä½•æ‹†åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œé»˜è®¤ä¸º0.01ã€‚è‹¥ä¸éœ€è¦åˆ‡åˆ†éªŒè¯é›†ï¼Œè®¾ç½®ä¸º0å³å¯
- data_seed: æ•°æ®é›†éšæœºç§å­ï¼Œé»˜è®¤ä¸º42
- ğŸ”¥dataset_num_proc: æ•°æ®é›†é¢„å¤„ç†çš„è¿›ç¨‹æ•°ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥streaming: æµå¼è¯»å–å¹¶å¤„ç†æ•°æ®é›†ï¼Œé»˜è®¤Falseã€‚é€šå¸¸åœ¨å¤„ç†å¤§å‹æ•°æ®é›†æ—¶ï¼Œè®¾ç½®ä¸ºTrue
- enable_cache: æ•°æ®é›†é¢„å¤„ç†ä½¿ç”¨cacheï¼Œé»˜è®¤False
- download_mode: æ•°æ®é›†ä¸‹è½½æ¨¡å¼ï¼ŒåŒ…å«`reuse_dataset_if_exists`å’Œ`force_redownload`ï¼Œé»˜è®¤ä¸ºreuse_dataset_if_exists
- columns: ç”¨äºå¯¹æ•°æ®é›†è¿›è¡Œåˆ—æ˜ å°„ï¼Œä½¿æ•°æ®é›†æ»¡è¶³AutoPreprocessorå¯ä»¥å¤„ç†çš„æ ·å¼ï¼Œå…·ä½“æŸ¥çœ‹[è¿™é‡Œ](../Customization/è‡ªå®šä¹‰æ•°æ®é›†.md)ã€‚ä½ å¯ä»¥ä¼ å…¥jsonå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š`'{"text1": "query", "text2": "response"}'`ï¼Œé»˜è®¤ä¸ºNoneã€‚
- strict: å¦‚æœä¸ºTrueï¼Œåˆ™æ•°æ®é›†åªè¦æŸè¡Œæœ‰é—®é¢˜ç›´æ¥æŠ›é”™ï¼Œå¦åˆ™ä¼šä¸¢å¼ƒå‡ºé”™æ•°æ®æ ·æœ¬ã€‚é»˜è®¤False
- remove_unused_columns: æ˜¯å¦åˆ é™¤æ•°æ®é›†ä¸­ä¸è¢«ä½¿ç”¨çš„åˆ—ï¼Œé»˜è®¤ä¸ºTrue
- ğŸ”¥model_name: ä»…ç”¨äºè‡ªæˆ‘è®¤çŸ¥ä»»åŠ¡ï¼Œåªå¯¹`swift/self-cognition`æ•°æ®é›†ç”Ÿæ•ˆï¼Œæ›¿æ¢æ‰æ•°æ®é›†ä¸­çš„`{{NAME}}`é€šé…ç¬¦ã€‚ä¼ å…¥æ¨¡å‹ä¸­æ–‡åå’Œè‹±æ–‡åï¼Œä»¥ç©ºæ ¼åˆ†éš”ï¼Œä¾‹å¦‚ï¼š`--model_name å°é»„ 'Xiao Huang'`ã€‚é»˜è®¤ä¸ºNone
- ğŸ”¥model_author: ä»…ç”¨äºè‡ªæˆ‘è®¤çŸ¥ä»»åŠ¡ï¼Œåªå¯¹`swift/self-cognition`æ•°æ®é›†ç”Ÿæ•ˆï¼Œæ›¿æ¢æ‰æ•°æ®é›†ä¸­çš„`{{AUTHOR}}`é€šé…ç¬¦ã€‚ä¼ å…¥æ¨¡å‹ä½œè€…çš„ä¸­æ–‡åå’Œè‹±æ–‡åï¼Œä»¥ç©ºæ ¼åˆ†éš”ï¼Œä¾‹å¦‚ï¼š`--model_author 'é­”æ­' 'ModelScope'`ã€‚é»˜è®¤ä¸ºNone
- custom_dataset_info: è‡ªå®šä¹‰æ•°æ®é›†æ³¨å†Œçš„jsonæ–‡ä»¶è·¯å¾„ï¼Œå‚è€ƒ[è‡ªå®šä¹‰æ•°æ®é›†](../Customization/è‡ªå®šä¹‰æ•°æ®é›†.md)ã€‚é»˜è®¤ä¸º`[]`

### æ¨¡æ¿å‚æ•°
- ğŸ”¥template: å¯¹è¯æ¨¡æ¿ç±»å‹ã€‚é»˜è®¤ä¸ºNoneï¼Œè‡ªåŠ¨é€‰æ‹©å¯¹åº”modelçš„templateç±»å‹
- ğŸ”¥system: è‡ªå®šä¹‰systemå­—æ®µï¼Œå¯ä»¥ä¼ å…¥å­—ç¬¦ä¸²æˆ–è€…txtæ–‡ä»¶è·¯å¾„ã€‚é»˜è®¤ä¸ºNoneï¼Œä½¿ç”¨templateçš„é»˜è®¤system
  - æ³¨æ„ï¼šæ•°æ®é›†ä¸­çš„systemä¼˜å…ˆçº§æœ€é«˜ï¼Œç„¶åæ˜¯`--system`ï¼Œæœ€åæ˜¯å®šä¹‰åœ¨templateä¸­çš„`default_system`ã€‚
- ğŸ”¥max_length: å•æ ·æœ¬çš„tokensæœ€å¤§é•¿åº¦ã€‚é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸ºæ¨¡å‹æ”¯æŒçš„tokensæœ€å¤§é•¿åº¦(max_model_len)
  - æ³¨æ„ï¼šPPOã€GRPOå’Œæ¨ç†æƒ…å†µä¸‹ï¼Œmax_lengthä»£è¡¨max_prompt_length
- truncation_strategy: å¦‚æœå•æ ·æœ¬çš„tokensè¶…è¿‡`max_length`å¦‚ä½•å¤„ç†ï¼Œæ”¯æŒ`delete`, `left`å’Œ`right`ï¼Œä»£è¡¨åˆ é™¤ã€å·¦ä¾§è£å‰ªå’Œå³ä¾§è£å‰ªï¼Œé»˜è®¤ä¸º'delete'
- ğŸ”¥max_pixels: å¤šæ¨¡æ€æ¨¡å‹è¾“å…¥å›¾ç‰‡çš„æœ€å¤§åƒç´ æ•°ï¼ˆH\*Wï¼‰ï¼Œå°†è¶…è¿‡è¯¥é™åˆ¶çš„å›¾åƒè¿›è¡Œç¼©æ”¾ã€‚é»˜è®¤ä¸ºNoneï¼Œä¸é™åˆ¶æœ€å¤§åƒç´ æ•°
- tools_prompt: æ™ºèƒ½ä½“è®­ç»ƒæ—¶çš„å·¥å…·åˆ—è¡¨è½¬ä¸ºsystemçš„æ ¼å¼ï¼Œè¯·å‚è€ƒ[æ™ºèƒ½ä½“è®­ç»ƒ](./æ™ºèƒ½ä½“çš„æ”¯æŒ.md)ã€‚å¯é€‰ä¸º'react_en'ã€'react_zh'ã€'glm4'ã€'toolbench'ã€'qwen'ï¼Œé»˜è®¤ä¸º'react_en'
- norm_bbox: æ§åˆ¶å¦‚ä½•å¯¹bboxè¿›è¡Œç¼©æ”¾ã€‚å¯é€‰é¡¹ä¸º'norm1000', 'none'ã€‚å…¶ä¸­'norm1000'ä»£è¡¨å¯¹bboxè¿›è¡Œåƒåˆ†ä½åæ ‡ç¼©æ”¾ï¼Œ'none'ä»£è¡¨ä¸ç¼©æ”¾ã€‚é»˜è®¤ä¸ºNoneï¼Œæ ¹æ®æ¨¡å‹è¿›è¡Œè‡ªåŠ¨é€‰æ‹©
- response_prefix: responseçš„å‰ç¼€å­—ç¬¦ï¼Œä¾‹å¦‚QwQ-32Bå°†response_prefixè®¾ç½®ä¸º`'<think>\n'`ã€‚é»˜è®¤ä¸ºNoneï¼Œæ ¹æ®æ¨¡å‹è‡ªåŠ¨è®¾ç½®
- padding_side: å½“è®­ç»ƒ`batch_size>=2`æ—¶çš„padding_sideï¼Œå¯é€‰å€¼ä¸º'left'ã€'right'ï¼Œé»˜è®¤ä¸º'right'ã€‚ï¼ˆæ¨ç†æ—¶çš„batch_size>=2æ—¶ï¼Œåªè¿›è¡Œå·¦paddingï¼‰
- loss_scale: è®­ç»ƒtokensçš„lossæƒé‡è®¾ç½®ã€‚é»˜è®¤ä¸º`'default'`ï¼Œä»£è¡¨æ‰€æœ‰responseï¼ˆå«historyï¼‰ä»¥1è®¡ç®—äº¤å‰ç†µæŸå¤±ã€‚å¯é€‰å€¼ä¸º'default'ã€'last_round'ã€'all'ï¼Œä»¥åŠagentéœ€è¦çš„loss_scale: 'react'ã€'agentflan'ã€'alpha_umi'å’Œ'qwen'ã€‚å…¶ä¸­'last_round'ä»£è¡¨åªè®¡ç®—æœ€åä¸€è½®responseçš„æŸå¤±ï¼Œ'all'ä»£è¡¨è®¡ç®—æ‰€æœ‰tokensçš„æŸå¤±ã€‚agentéƒ¨åˆ†å¯ä»¥æŸ¥çœ‹[æ’ä»¶åŒ–](../Customization/æ’ä»¶åŒ–.md)å’Œ[æ™ºèƒ½ä½“è®­ç»ƒ](./æ™ºèƒ½ä½“çš„æ”¯æŒ.md)
- sequence_parallel_size: åºåˆ—å¹¶è¡Œæ•°é‡ï¼Œé»˜è®¤ä¸º1ã€‚å‚è€ƒ[example](https://github.com/modelscope/ms-swift/tree/main/examples/train/sequence_parallel/train.sh)
  - æ³¨æ„ï¼šè¯¥åŠŸèƒ½å€ŸåŠ©[xtuner](https://github.com/InternLM/xtuner)èƒ½åŠ›å®ç°ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ¨¡å‹éƒ½æ”¯æŒè¯¥å‚æ•°
- use_chat_template: ä½¿ç”¨chatæ¨¡æ¿æˆ–generationæ¨¡æ¿ï¼Œé»˜è®¤ä¸º`True`ã€‚`swift pt`ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºgenerationæ¨¡æ¿
- template_backend: é€‰æ‹©templateåç«¯ï¼Œå¯é€‰ä¸º'swift'ã€'jinja'ï¼Œé»˜è®¤ä¸º'swift'ã€‚å¦‚æœä½¿ç”¨jinjaï¼Œåˆ™ä½¿ç”¨transformersçš„`apply_chat_template`ã€‚
  - æ³¨æ„ï¼šjinjaçš„templateåç«¯åªæ”¯æŒæ¨ç†ï¼Œä¸æ”¯æŒè®­ç»ƒã€‚

### ç”Ÿæˆå‚æ•°
å‚è€ƒ[generation_config](https://huggingface.co/docs/transformers/main_classes/text_generation#transformers.GenerationConfig)æ–‡æ¡£

- ğŸ”¥max_new_tokens: æ¨ç†æœ€å¤§ç”Ÿæˆæ–°tokensçš„æ•°é‡ã€‚é»˜è®¤ä¸ºNoneï¼Œæ— é™åˆ¶
- temperature: æ¸©åº¦å‚æ•°ã€‚é»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.jsonã€‚
  - æ³¨æ„ï¼šdo_sampleå‚æ•°åœ¨æœ¬ç‰ˆæœ¬ä¸­ç§»é™¤äº†ï¼Œè¯·å°†temperatureé…ç½®ä¸º0æ¥è¾¾åˆ°ç›¸åŒæ•ˆæœ
- top_k: top_kå‚æ•°ï¼Œé»˜è®¤ä¸ºNoneã€‚è¯»å–generation_config.json
- top_p: top_på‚æ•°ï¼Œé»˜è®¤ä¸ºNoneã€‚è¯»å–generation_config.json
- repetition_penalty: é‡å¤æƒ©ç½šé¡¹ã€‚é»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.json
- num_beams: beam searchçš„å¹¶è¡Œä¿ç•™æ•°é‡ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥stream: æµå¼è¾“å‡ºï¼Œé»˜è®¤ä¸º`False`
- stop_words: é™¤äº†eos_tokenå¤–é¢å¤–çš„åœæ­¢è¯ï¼Œé»˜è®¤ä¸º`[]`ã€‚
  - æ³¨æ„ï¼šeos_tokenä¼šåœ¨è¾“å‡ºrespsoneä¸­è¢«åˆ é™¤ï¼Œé¢å¤–åœæ­¢è¯ä¼šåœ¨è¾“å‡ºä¸­ä¿ç•™
- logprobs: æ˜¯å¦è¾“å‡ºlogprobsï¼Œé»˜è®¤ä¸ºFalse
- top_logprobs: è¾“å‡ºtop_logprobsçš„æ•°é‡ï¼Œé»˜è®¤ä¸ºNone

### é‡åŒ–å‚æ•°
ä»¥ä¸‹ä¸ºåŠ è½½æ¨¡å‹æ—¶é‡åŒ–çš„å‚æ•°ï¼Œå…·ä½“å«ä¹‰å¯ä»¥æŸ¥çœ‹[é‡åŒ–](https://huggingface.co/docs/transformers/main/en/main_classes/quantization)æ–‡æ¡£ã€‚è¿™é‡Œä¸åŒ…å«`swift export`ä¸­æ¶‰åŠçš„`gptq`ã€`awq`é‡åŒ–å‚æ•°

- ğŸ”¥quant_method: åŠ è½½æ¨¡å‹æ—¶é‡‡ç”¨çš„é‡åŒ–æ–¹æ³•ï¼Œå¯é€‰é¡¹ä¸º`bnb`ã€`hqq`ã€`eetq`
- ğŸ”¥quant_bits: é‡åŒ–bitsæ•°ï¼Œé»˜è®¤ä¸ºNone
- hqq_axis: hqqé‡åŒ–axisï¼Œé»˜è®¤ä¸ºNone
- bnb_4bit_compute_dtype: bnbé‡åŒ–è®¡ç®—ç±»å‹ï¼Œå¯é€‰ä¸º`float16`ã€`bfloat16`ã€`float32`ã€‚é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸º`torch_dtype`
- bnb_4bit_quant_type: bnbé‡åŒ–ç±»å‹ï¼Œæ”¯æŒ`fp4`å’Œ`nf4`ï¼Œé»˜è®¤ä¸º`nf4`
- bnb_4bit_use_double_quant: æ˜¯å¦ä½¿ç”¨åŒé‡é‡åŒ–ï¼Œé»˜è®¤ä¸º`True`
- bnb_4bit_quant_storage: bnbé‡åŒ–å­˜å‚¨ç±»å‹ï¼Œé»˜è®¤ä¸ºNone


## åŸå­å‚æ•°

### Seq2SeqTrainerå‚æ•°

è¯¥å‚æ•°åˆ—è¡¨ç»§æ‰¿è‡ªtransformers `Seq2SeqTrainingArguments`ï¼Œms-swiftå¯¹å…¶é»˜è®¤å€¼è¿›è¡Œäº†è¦†ç›–ã€‚æœªåˆ—å‡ºçš„è¯·å‚è€ƒ[HFå®˜æ–¹æ–‡æ¡£](https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.Seq2SeqTrainingArguments)

- ğŸ”¥output_dir: é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸º`output/<model_name>`
- ğŸ”¥gradient_checkpointing: æ˜¯å¦ä½¿ç”¨gradient_checkpointingï¼Œé»˜è®¤ä¸ºTrue
- ğŸ”¥deepspeed: é»˜è®¤ä¸ºNoneã€‚å¯ä»¥è®¾ç½®ä¸º'zero0', 'zero1', 'zero2', 'zero3', 'zero2_offload', 'zero3_offload'æ¥ä½¿ç”¨ms-swiftå†…ç½®çš„deepspeedé…ç½®æ–‡ä»¶
- zero_hpz_partition_size: é»˜è®¤ä¸ºNoneï¼Œè¿™ä¸ªå‚æ•°æ˜¯ZeRO++çš„ç‰¹æ€§ï¼Œå³nodeå†…æ¨¡å‹åˆ†ç‰‡ï¼Œnodeé—´æ•°æ®åˆ†ç‰‡ï¼Œå¦‚æœé‡åˆ°grad_norm NaNï¼Œè¯·å°è¯•ä½¿ç”¨`--torch_dtype float16`
- ğŸ”¥per_device_train_batch_size: é»˜è®¤å€¼1
- ğŸ”¥per_device_eval_batch_size: é»˜è®¤å€¼1
- weight_decay: weightè¡°å‡ç³»æ•°ï¼Œé»˜è®¤å€¼0.1
- adam_beta2: é»˜è®¤ä¸º0.95
- ğŸ”¥learning_rate: å­¦ä¹ ç‡ï¼Œå…¨å‚æ•°é»˜è®¤ä¸º1e-5ï¼ŒLoRAç­‰tunersä¸º1e-4
- lr_scheduler_type: lr_schedulerç±»å‹ï¼Œé»˜è®¤ä¸º'cosine'
- lr_scheduler_kwargs: lr_schedulerå…¶ä»–å‚æ•°ã€‚é»˜è®¤ä¸ºNone
- ğŸ”¥gradient_checkpointing_kwargs: ä¼ å…¥`torch.utils.checkpoint`ä¸­çš„å‚æ•°ã€‚ä¾‹å¦‚è®¾ç½®ä¸º`--gradient_checkpointing_kwargs '{"use_reentrant": false}'`ã€‚é»˜è®¤ä¸ºNone
- report_to: é»˜è®¤å€¼ä¸º`tensorboard`ã€‚ä½ ä¹Ÿå¯ä»¥æŒ‡å®š`--report_to tensorboard wandb swanlab`ã€`--report_to all`
- logging_first_step: æ˜¯å¦è®°å½•ç¬¬ä¸€ä¸ªstepçš„æ—¥å¿—ï¼Œé»˜è®¤ä¸ºTrue
- logging_steps: æ—¥å¿—æ‰“å°é—´éš”ï¼Œé»˜è®¤ä¸º5
- predict_with_generate: éªŒè¯æ—¶ä½¿ç”¨ç”Ÿæˆå¼çš„æ–¹å¼ï¼Œé»˜è®¤ä¸ºFalseã€‚
- metric_for_best_model: é»˜è®¤ä¸ºNoneï¼Œå³å½“`predict_with_generate`è®¾ç½®ä¸ºFalseæ—¶ï¼Œè®¾ç½®ä¸º'loss'ï¼Œå¦åˆ™è®¾ç½®ä¸º'rouge-l'ï¼ˆåœ¨PPOè®­ç»ƒæ—¶ï¼Œä¸è¿›è¡Œé»˜è®¤å€¼è®¾ç½®ï¼›GRPOè®­ç»ƒè®¾ç½®ä¸º'reward'ï¼‰ã€‚
- greater_is_better: é»˜è®¤ä¸ºNoneï¼Œå³å½“`metric_for_best_model`å«'loss'æ—¶ï¼Œè®¾ç½®ä¸ºFalseï¼Œå¦åˆ™è®¾ç½®ä¸ºTrue.


å…¶ä»–é‡è¦å‚æ•°ï¼š
- ğŸ”¥num_train_epochs: è®­ç»ƒçš„epochæ•°ï¼Œé»˜è®¤ä¸º3
- ğŸ”¥gradient_accumulation_steps: æ¢¯åº¦ç´¯åŠ ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥save_strategy: ä¿å­˜æ¨¡å‹çš„ç­–ç•¥ï¼Œå¯é€‰ä¸º'no'ã€'steps'ã€'epoch'ï¼Œé»˜è®¤ä¸º'steps'
- ğŸ”¥save_steps: é»˜è®¤ä¸º500
- ğŸ”¥eval_strategy: è¯„ä¼°ç­–ç•¥ã€‚é»˜è®¤ä¸ºNoneï¼Œè·Ÿéš`save_strategy`çš„ç­–ç•¥
- ğŸ”¥eval_steps: é»˜è®¤ä¸ºNoneï¼Œå¦‚æœå­˜åœ¨è¯„ä¼°æ•°æ®é›†ï¼Œåˆ™è·Ÿéš`save_steps`çš„ç­–ç•¥
- ğŸ”¥save_total_limit: æœ€å¤šä¿å­˜çš„checkpointæ•°ï¼Œä¼šå°†è¿‡æœŸçš„checkpointè¿›è¡Œåˆ é™¤ã€‚é»˜è®¤ä¸ºNoneï¼Œä¿å­˜æ‰€æœ‰çš„checkpoint
- max_steps: æœ€å¤§è®­ç»ƒçš„stepsæ•°ã€‚åœ¨æ•°æ®é›†ä¸ºæµå¼æ—¶éœ€è¦è¢«è®¾ç½®ã€‚é»˜è®¤ä¸º-1
- ğŸ”¥warmup_ratio: é»˜è®¤ä¸º0.
- save_on_each_node: é»˜è®¤ä¸ºFalseã€‚åœ¨å¤šæœºè®­ç»ƒæ—¶éœ€è¦è¢«è€ƒè™‘
- save_only_model: æ˜¯å¦åªä¿å­˜æ¨¡å‹æƒé‡è€Œä¸åŒ…å«ä¼˜åŒ–å™¨çŠ¶æ€ï¼Œéšæœºç§å­çŠ¶æ€ç­‰å†…å®¹ã€‚é»˜è®¤ä¸ºFalse
- ğŸ”¥resume_from_checkpoint: æ–­ç‚¹ç»­è®­å‚æ•°ï¼Œä¼ å…¥checkpointè·¯å¾„ã€‚é»˜è®¤ä¸ºNone
  - æ³¨æ„: resume_from_checkpointä¼šè¯»å–æ¨¡å‹æƒé‡ï¼Œä¼˜åŒ–å™¨æƒé‡ï¼Œéšæœºç§å­ï¼Œå¹¶ä»ä¸Šæ¬¡è®­ç»ƒçš„stepsç»§ç»­å¼€å§‹è®­ç»ƒã€‚ä½ å¯ä»¥æŒ‡å®š`--resume_only_model`åªè¯»å–æ¨¡å‹æƒé‡ã€‚
- ğŸ”¥ddp_backend: é»˜è®¤ä¸ºNoneï¼Œå¯é€‰ä¸º"nccl"ã€"gloo"ã€"mpi"ã€"ccl"ã€"hccl" ã€"cncl"ã€"mccl"
- ğŸ”¥ddp_find_unused_parameters: é»˜è®¤ä¸ºNone
- ğŸ”¥dataloader_num_workers: é»˜è®¤ä¸º0
- dataloader_pin_memory: é»˜è®¤ä¸ºTrue
- dataloader_persistent_workers: é»˜è®¤ä¸ºFalse
- dataloader_prefetch_factor: é»˜è®¤ä¸º2
- ğŸ”¥neftune_noise_alpha: neftuneæ·»åŠ çš„å™ªå£°ç³»æ•°, é»˜è®¤ä¸º0ï¼Œé€šå¸¸å¯ä»¥è®¾ç½®ä¸º5ã€10ã€15
- average_tokens_across_devices: æ˜¯å¦åœ¨è®¾å¤‡ä¹‹é—´è¿›è¡Œtokenæ•°å¹³å‡ã€‚å¦‚æœè®¾ç½®ä¸ºTrueï¼Œå°†ä½¿ç”¨all_reduceåŒæ­¥`num_tokens_in_batch`ä»¥è¿›è¡Œç²¾ç¡®çš„æŸå¤±è®¡ç®—ã€‚é»˜è®¤ä¸ºFalse
- max_grad_norm: æ¢¯åº¦è£å‰ªã€‚é»˜è®¤ä¸º1.
- push_to_hub: æ¨é€checkpointåˆ°hubã€‚é»˜è®¤ä¸ºFalse
- hub_model_id: é»˜è®¤ä¸ºNone
- hub_private_repo: é»˜è®¤ä¸ºFalse

### Tunerå‚æ•°
- ğŸ”¥freeze_llm: è¯¥å‚æ•°åªå¯¹å¤šæ¨¡æ€æ¨¡å‹ç”Ÿæ•ˆï¼Œå¯ç”¨äºå…¨å‚å’ŒLoRAï¼Œä½†å«ä¹‰ä¸åŒã€‚è‹¥æ˜¯å…¨å‚æ•°è®­ç»ƒï¼Œå°†freeze_llmè®¾ç½®ä¸ºTrueå°†ä¼šå°†llméƒ¨åˆ†æƒé‡è¿›è¡Œå†»ç»“ï¼Œè‹¥æ˜¯LoRAè®­ç»ƒä¸”`target_modules`è®¾ç½®ä¸º'all-linear'ï¼Œå°†freeze_llmè®¾ç½®ä¸ºTrueå°†ä¼šå–æ¶ˆåœ¨llméƒ¨åˆ†æ·»åŠ LoRAæ¨¡å—ã€‚è¯¥å‚æ•°é»˜è®¤ä¸ºFalse
- ğŸ”¥freeze_vit: è¯¥å‚æ•°åªå¯¹å¤šæ¨¡æ€æ¨¡å‹ç”Ÿæ•ˆï¼Œå¯ç”¨äºå…¨å‚å’ŒLoRAï¼Œå«ä¹‰å‚è€ƒ`freeze_llm`ã€‚é»˜è®¤ä¸ºTrue
- ğŸ”¥freeze_aligner: è¯¥å‚æ•°åªå¯¹å¤šæ¨¡æ€æ¨¡å‹ç”Ÿæ•ˆï¼Œå¯ç”¨äºå…¨å‚å’ŒLoRAï¼Œå«ä¹‰å‚è€ƒ`freeze_llm`ã€‚é»˜è®¤ä¸ºTrue
- ğŸ”¥target_modules: æŒ‡å®šloraæ¨¡å—, é»˜è®¤ä¸º`all-linear`. åœ¨LLMå’Œå¤šæ¨¡æ€LLMä¸­ï¼Œå…¶è¡Œä¸ºæœ‰æ‰€ä¸åŒ. è‹¥æ˜¯LLMåˆ™è‡ªåŠ¨å¯»æ‰¾é™¤lm_headå¤–çš„linearå¹¶é™„åŠ tunerï¼Œè‹¥æ˜¯å¤šæ¨¡æ€LLMï¼Œåˆ™é»˜è®¤åªåœ¨LLMä¸Šé™„åŠ tunerï¼Œè¯¥è¡Œä¸ºå¯ä»¥è¢«`freeze_llm`ã€`freeze_vit`ã€`freeze_aligner`æ§åˆ¶ã€‚è¯¥å‚æ•°ä¸é™äºLoRAï¼Œå¯ç”¨äºå…¶ä»–tuners
- ğŸ”¥target_regex: æŒ‡å®šloraæ¨¡å—çš„regexè¡¨è¾¾å¼ï¼Œé»˜è®¤ä¸º`None`ã€‚å¦‚æœè¯¥å€¼ä¼ å…¥ï¼Œåˆ™target_moduleså‚æ•°å¤±æ•ˆã€‚è¯¥å‚æ•°ä¸é™äºLoRAï¼Œå¯ç”¨äºå…¶ä»–tuners
- init_weights: åˆå§‹åŒ–weightsçš„æ–¹æ³•ï¼ŒLoRAå¯ä»¥æŒ‡å®šä¸º`true`ã€`false`ã€`gaussian`ã€`pissa`ã€`pissa_niter_[number of iters]`ï¼ŒBoneå¯ä»¥æŒ‡å®šä¸º`true`ã€`false`ã€`bat`ã€‚é»˜è®¤å€¼`true`
- ğŸ”¥modules_to_save: åœ¨å·²é™„åŠ tuneråï¼Œé¢å¤–æŒ‡å®šä¸€éƒ¨åˆ†åŸæ¨¡å‹æ¨¡å—å‚ä¸è®­ç»ƒå’Œå­˜å‚¨ã€‚é»˜è®¤ä¸º`[]`. è¯¥å‚æ•°ä¸é™äºLoRAï¼Œå¯ç”¨äºå…¶ä»–tuners

#### å…¨å‚
- freeze_parameters: éœ€è¦è¢«å†»ç»“å‚æ•°çš„å‰ç¼€ï¼Œé»˜è®¤ä¸º`[]`
- freeze_parameters_ratio: ä»ä¸‹å¾€ä¸Šå†»ç»“çš„å‚æ•°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ã€‚å¯è®¾ç½®ä¸º1å°†æ‰€æœ‰å‚æ•°å†»ç»“ï¼Œç»“åˆ`trainable_parameters`è®¾ç½®å¯è®­ç»ƒå‚æ•°
- trainable_parameters: é¢å¤–å¯è®­ç»ƒå‚æ•°çš„å‰ç¼€ï¼Œé»˜è®¤ä¸º`[]`ã€‚
  - å¤‡æ³¨ï¼š`trainable_parameters`çš„ä¼˜å…ˆçº§é«˜äº`freeze_parameters`å’Œ`freeze_parameters_ratio`ã€‚å½“æŒ‡å®šå…¨å‚æ•°è®­ç»ƒæ—¶ï¼Œä¼šå°†æ‰€æœ‰æ¨¡å—è®¾ç½®ä¸ºå¯è®­ç»ƒçš„çŠ¶æ€ï¼Œéšåæ ¹æ®`freeze_parameters`ã€`freeze_parameters_ratio`å°†éƒ¨åˆ†å‚æ•°å†»ç»“ï¼Œæœ€åæ ¹æ®`trainable_parameters`é‡æ–°æ‰“å¼€éƒ¨åˆ†å‚æ•°å‚ä¸è®­ç»ƒ

#### LoRA
- ğŸ”¥lora_rank: é»˜è®¤ä¸º`8`
- ğŸ”¥lora_alpha: é»˜è®¤ä¸º`32`
- lora_dropout: é»˜è®¤ä¸º`0.05`
- lora_bias: é»˜è®¤ä¸º`'none'`ï¼Œå¯ä»¥é€‰æ‹©çš„å€¼: 'none'ã€'all'ã€‚å¦‚æœä½ è¦å°†biaså…¨éƒ½è®¾ç½®ä¸ºå¯è®­ç»ƒï¼Œä½ å¯ä»¥è®¾ç½®ä¸º`'all'`
- lora_dtype: æŒ‡å®šloraæ¨¡å—çš„dtypeç±»å‹ã€‚æ”¯æŒ'float16'ã€'bfloat16'ã€'float32'ã€‚é»˜è®¤ä¸ºNoneï¼Œè·ŸéšåŸæ¨¡å‹ç±»å‹
- ğŸ”¥use_dora: é»˜è®¤ä¸º`False`ï¼Œæ˜¯å¦ä½¿ç”¨`DoRA`
- use_rslora: é»˜è®¤ä¸º`False`ï¼Œæ˜¯å¦ä½¿ç”¨`RS-LoRA`
- ğŸ”¥lorap_lr_ratio: LoRA+å‚æ•°ï¼Œé»˜è®¤å€¼`None`ï¼Œå»ºè®®å€¼`10~16`ã€‚ä½¿ç”¨loraæ—¶æŒ‡å®šè¯¥å‚æ•°å¯ä½¿ç”¨lora+

##### LoRA-GA
- lora_ga_batch_size: é»˜è®¤å€¼ä¸º `2`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶ä½¿ç”¨çš„æ‰¹å¤„ç†å¤§å°ã€‚
- lora_ga_iters: é»˜è®¤å€¼ä¸º `2`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶çš„è¿­ä»£æ¬¡æ•°ã€‚
- lora_ga_max_length: é»˜è®¤å€¼ä¸º `1024`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶çš„æœ€å¤§è¾“å…¥é•¿åº¦ã€‚
- lora_ga_direction: é»˜è®¤å€¼ä¸º `ArB2r`ã€‚åœ¨ LoRA-GA ä¸­ä½¿ç”¨ä¼°è®¡æ¢¯åº¦è¿›è¡Œåˆå§‹åŒ–æ—¶çš„åˆå§‹æ–¹å‘ã€‚å…è®¸çš„å€¼æœ‰ï¼š`ArBr`ã€`A2rBr`ã€`ArB2r` å’Œ `random`ã€‚
- lora_ga_scale: é»˜è®¤å€¼ä¸º `stable`ã€‚LoRA-GA çš„åˆå§‹åŒ–ç¼©æ”¾æ–¹å¼ã€‚å…è®¸çš„å€¼æœ‰ï¼š`gd`ã€`unit`ã€`stable` å’Œ `weightS`ã€‚
- lora_ga_stable_gamma: é»˜è®¤å€¼ä¸º `16`ã€‚å½“åˆå§‹åŒ–æ—¶é€‰æ‹© `stable` ç¼©æ”¾æ—¶çš„ gamma å€¼ã€‚

#### FourierFt

FourierFtä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- fourier_n_frequency: å‚…é‡Œå¶å˜æ¢çš„é¢‘ç‡æ•°é‡, `int`ç±»å‹, ç±»ä¼¼äºLoRAä¸­çš„`r`. é»˜è®¤å€¼`2000`.
- fourier_scaling: WçŸ©é˜µçš„ç¼©æ”¾å€¼, `float`ç±»å‹, ç±»ä¼¼LoRAä¸­çš„`lora_alpha`. é»˜è®¤å€¼`300.0`.

#### BOFT

BOFTä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- boft_block_size: BOFTå—å°ºå¯¸, é»˜è®¤å€¼4.
- boft_block_num: BOFTå—æ•°é‡, ä¸èƒ½å’Œ`boft_block_size`åŒæ—¶ä½¿ç”¨.
- boft_dropout: boftçš„dropoutå€¼, é»˜è®¤0.0.

#### Vera

Veraä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- vera_rank: Vera Attentionçš„å°ºå¯¸, é»˜è®¤å€¼256.
- vera_projection_prng_key: æ˜¯å¦å­˜å‚¨Veraæ˜ å°„çŸ©é˜µ, é»˜è®¤ä¸ºTrue.
- vera_dropout: Veraçš„dropoutå€¼, é»˜è®¤`0.0`.
- vera_d_initial: Veraçš„dçŸ©é˜µçš„åˆå§‹å€¼, é»˜è®¤`0.1`.

#### GaLore

- ğŸ”¥use_galore: é»˜è®¤å€¼False, æ˜¯å¦ä½¿ç”¨GaLore.
- galore_target_modules: é»˜è®¤å€¼None, ä¸ä¼ çš„æƒ…å†µä¸‹å¯¹attentionå’Œmlpåº”ç”¨GaLore.
- galore_rank: é»˜è®¤å€¼128, GaLoreçš„rankå€¼.
- galore_update_proj_gap: é»˜è®¤å€¼50, åˆ†è§£çŸ©é˜µçš„æ›´æ–°é—´éš”.
- galore_scale: é»˜è®¤å€¼1.0, çŸ©é˜µæƒé‡ç³»æ•°.
- galore_proj_type: é»˜è®¤å€¼`std`, GaLoreçŸ©é˜µåˆ†è§£ç±»å‹.
- galore_optim_per_parameter: é»˜è®¤å€¼False, æ˜¯å¦ç»™æ¯ä¸ªGaloreç›®æ ‡Parameterè®¾å®šä¸€ä¸ªå•ç‹¬çš„optimizer.
- galore_with_embedding: é»˜è®¤å€¼False, æ˜¯å¦å¯¹embeddingåº”ç”¨GaLore.
- galore_quantization: æ˜¯å¦ä½¿ç”¨q-galore. é»˜è®¤å€¼`False`.
- galore_proj_quant: æ˜¯å¦å¯¹SVDåˆ†è§£çŸ©é˜µåšé‡åŒ–, é»˜è®¤`False`.
- galore_proj_bits: SVDé‡åŒ–bitæ•°.
- galore_proj_group_size: SVDé‡åŒ–åˆ†ç»„æ•°.
- galore_cos_threshold: æŠ•å½±çŸ©é˜µæ›´æ–°çš„cosç›¸ä¼¼åº¦é˜ˆå€¼. é»˜è®¤å€¼0.4.
- galore_gamma_proj: åœ¨æŠ•å½±çŸ©é˜µé€æ¸ç›¸ä¼¼åä¼šæ‹‰é•¿æ›´æ–°é—´éš”, æœ¬å‚æ•°ä¸ºæ¯æ¬¡æ‹‰é•¿é—´éš”çš„ç³»æ•°, é»˜è®¤å€¼2.
- galore_queue_size: è®¡ç®—æŠ•å½±çŸ©é˜µç›¸ä¼¼åº¦çš„é˜Ÿåˆ—é•¿åº¦, é»˜è®¤å€¼5.

#### LISA

æ³¨æ„:LISAä»…æ”¯æŒå…¨å‚æ•°ï¼Œå³train_type full`.

- ğŸ”¥lisa_activated_layers: é»˜è®¤å€¼`0`, ä»£è¡¨ä¸ä½¿ç”¨LISAï¼Œæ”¹ä¸ºé0ä»£è¡¨éœ€è¦æ¿€æ´»çš„layersä¸ªæ•°ï¼Œå»ºè®®è®¾ç½®ä¸º2æˆ–8.
- lisa_step_interval: é»˜è®¤å€¼`20`, å¤šå°‘iteråˆ‡æ¢å¯åå‘ä¼ æ’­çš„layers.

#### UNSLOTH

ğŸ”¥unslothæ— æ–°å¢å‚æ•°ï¼Œå¯¹å·²æœ‰å‚æ•°è¿›è¡Œè°ƒèŠ‚å³å¯æ”¯æŒ:

```
--tuner_backend unsloth
--train_type full/lora
--quant_bits 4
```

#### LLAMAPRO

- ğŸ”¥llamapro_num_new_blocks: é»˜è®¤å€¼`4`, æ’å…¥çš„æ–°layersæ€»æ•°.
- llamapro_num_groups: é»˜è®¤å€¼`None`, åˆ†ä¸ºå¤šå°‘ç»„æ’å…¥new_blocks, å¦‚æœä¸º`None`åˆ™ç­‰äº`llamapro_num_new_blocks`, å³æ¯ä¸ªæ–°çš„layerå•ç‹¬æ’å…¥åŸæ¨¡å‹.

#### AdaLoRA

ä»¥ä¸‹å‚æ•°`train_type`è®¾ç½®ä¸º`adalora`æ—¶ç”Ÿæ•ˆ. adaloraçš„`target_modules`ç­‰å‚æ•°ç»§æ‰¿äºloraçš„å¯¹åº”å‚æ•°, ä½†`lora_dtype`å‚æ•°ä¸ç”Ÿæ•ˆ.

- adalora_target_r: é»˜è®¤å€¼`8`, adaloraçš„å¹³å‡rank.
- adalora_init_r: é»˜è®¤å€¼`12`, adaloraçš„åˆå§‹rank.
- adalora_tinit: é»˜è®¤å€¼`0`, adaloraçš„åˆå§‹warmup.
- adalora_tfinal: é»˜è®¤å€¼`0`, adaloraçš„final warmup.
- adalora_deltaT: é»˜è®¤å€¼`1`, adaloraçš„stepé—´éš”.
- adalora_beta1: é»˜è®¤å€¼`0.85`, adaloraçš„EMAå‚æ•°.
- adalora_beta2: é»˜è®¤å€¼`0.85`, adaloraçš„EMAå‚æ•°.
- adalora_orth_reg_weight: é»˜è®¤å€¼`0.5`, adaloraçš„æ­£åˆ™åŒ–å‚æ•°.

#### ReFT

ä»¥ä¸‹å‚æ•°`train_type`è®¾ç½®ä¸º`reft`æ—¶ç”Ÿæ•ˆ.

> 1. ReFTæ— æ³•åˆå¹¶tuner
> 2. ReFTå’Œgradient_checkpointingä¸å…¼å®¹
> 3. å¦‚æœä½¿ç”¨DeepSpeedé‡åˆ°é—®é¢˜è¯·æš‚æ—¶å¸è½½DeepSpeed

- ğŸ”¥reft_layers: ReFTåº”ç”¨äºå“ªäº›å±‚ä¸Š, é»˜è®¤ä¸º`None`, ä»£è¡¨æ‰€æœ‰å±‚, å¯ä»¥è¾“å…¥å±‚å·çš„list, ä¾‹å¦‚reft_layers 1 2 3 4`
- ğŸ”¥reft_rank: ReFTçŸ©é˜µçš„rank, é»˜è®¤ä¸º`4`.
- reft_intervention_type: ReFTçš„ç±»å‹, æ”¯æŒ'NoreftIntervention', 'LoreftIntervention', 'ConsreftIntervention', 'LobireftIntervention', 'DireftIntervention', 'NodireftIntervention', é»˜è®¤ä¸º`LoreftIntervention`.
- reft_args: ReFT Interventionä¸­çš„å…¶ä»–æ”¯æŒå‚æ•°, ä»¥json-stringæ ¼å¼è¾“å…¥.

#### Liger

- use_liger: ä½¿ç”¨liger-kernelè¿›è¡Œè®­ç»ƒ.

### LMDeployå‚æ•°
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[lmdeployæ–‡æ¡£](https://lmdeploy.readthedocs.io/en/latest/api/pipeline.html#turbomindengineconfig)

- ğŸ”¥tp: tensorå¹¶è¡Œåº¦ã€‚é»˜è®¤ä¸º`1`
- session_len: é»˜è®¤ä¸º`None`
- cache_max_entry_count: é»˜è®¤ä¸º`0.8`
- quant_policy: é»˜è®¤ä¸º`0`
- vision_batch_size: é»˜è®¤ä¸º`1`

### vLLMå‚æ•°
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[vllmæ–‡æ¡£](https://docs.vllm.ai/en/latest/serving/engine_args.html)

- ğŸ”¥gpu_memory_utilization: é»˜è®¤å€¼`0.9`
- ğŸ”¥tensor_parallel_size: é»˜è®¤ä¸º`1`
- pipeline_parallel_size: é»˜è®¤ä¸º`1`
- max_num_seqs: é»˜è®¤ä¸º`256`
- ğŸ”¥max_model_len: é»˜è®¤ä¸º`None`
- disable_custom_all_reduce: é»˜è®¤ä¸º`False`
- enforce_eager: vllmä½¿ç”¨pytorch eageræ¨¡å¼è¿˜æ˜¯å»ºç«‹cuda graphï¼Œé»˜è®¤ä¸º`False`ã€‚è®¾ç½®ä¸ºTrueå¯ä»¥èŠ‚çº¦æ˜¾å­˜ï¼Œä½†ä¼šå½±å“æ•ˆç‡
- ğŸ”¥limit_mm_per_prompt: æ§åˆ¶vllmä½¿ç”¨å¤šå›¾ï¼Œé»˜è®¤ä¸º`None`ã€‚ä¾‹å¦‚ä¼ å…¥`--limit_mm_per_prompt '{"image": 5, "video": 2}'`
- vllm_max_lora_rank: é»˜è®¤ä¸º`16`ã€‚vllmå¯¹äºloraæ”¯æŒçš„å‚æ•°
- enable_prefix_caching: å¼€å¯vllmçš„è‡ªåŠ¨å‰ç¼€ç¼“å­˜ï¼ŒèŠ‚çº¦é‡å¤æŸ¥è¯¢å‰ç¼€çš„å¤„ç†æ—¶é—´ã€‚é»˜è®¤ä¸º`False`


### åˆå¹¶å‚æ•°

- ğŸ”¥merge_lora: æ˜¯å¦åˆå¹¶loraï¼Œæœ¬å‚æ•°æ”¯æŒloraã€llamaproã€longloraï¼Œé»˜è®¤ä¸ºFalseã€‚ä¾‹å­å‚æ•°[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/export/merge_lora.sh)
- safe_serialization: æ˜¯å¦å­˜å‚¨safetensorsï¼Œé»˜è®¤ä¸ºTrue
- max_shard_size: å•å­˜å‚¨æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œé»˜è®¤'5GB'


## é›†æˆå‚æ•°

### è®­ç»ƒå‚æ•°
è®­ç»ƒå‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)ã€[Seq2SeqTrainerå‚æ•°](#Seq2SeqTrainerå‚æ•°)ã€[tunerå‚æ•°](#tunerå‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†:

- add_version: åœ¨output_dirä¸Šé¢å¤–å¢åŠ ç›®å½•`'<ç‰ˆæœ¬å·>-<æ—¶é—´æˆ³>'`é˜²æ­¢æƒé‡è¦†ç›–ï¼Œé»˜è®¤ä¸ºTrue
- resume_only_model: é»˜è®¤ä¸ºFalseã€‚å¦‚æœåœ¨æŒ‡å®šresume_from_checkpointçš„åŸºç¡€ä¸Šï¼Œå°†è¯¥å‚æ•°è®¾ç½®ä¸ºTrueï¼Œåˆ™ä»…resumeæ¨¡å‹æƒé‡
- check_model: æ£€æŸ¥æœ¬åœ°æ¨¡å‹æ–‡ä»¶æœ‰æŸåæˆ–ä¿®æ”¹å¹¶ç»™å‡ºæç¤ºï¼Œé»˜è®¤ä¸ºTrueã€‚å¦‚æœæ˜¯æ–­ç½‘ç¯å¢ƒï¼Œè¯·è®¾ç½®ä¸ºFalse
- ğŸ”¥create_checkpoint_symlink: é¢å¤–åˆ›å»ºcheckpointè½¯é“¾æ¥ï¼Œæ–¹ä¾¿ä¹¦å†™è‡ªåŠ¨åŒ–è®­ç»ƒè„šæœ¬ã€‚best_modelå’Œlast_modelçš„è½¯é“¾æ¥è·¯å¾„åˆ†åˆ«ä¸ºf'{output_dir}/best'å’Œf'{output_dir}/last'
- loss_type: lossç±»å‹ã€‚é»˜è®¤ä¸ºNoneï¼Œä½¿ç”¨æ¨¡å‹è‡ªå¸¦æŸå¤±å‡½æ•°
- packing: æ˜¯å¦ä½¿ç”¨åºåˆ—packingï¼Œé»˜è®¤ä¸ºFalse
  - æ³¨æ„ï¼šä½¿ç”¨packingè¯·ç»“åˆ`--attn_impl flash_attn`ä½¿ç”¨ï¼Œå…·ä½“æŸ¥çœ‹[è¯¥PR](https://github.com/huggingface/transformers/pull/31629)ã€‚packingæš‚ä¸æ”¯æŒå¤šæ¨¡æ€æ¨¡å‹ã€‚
- ğŸ”¥lazy_tokenize: æ˜¯å¦ä½¿ç”¨lazy_tokenizeã€‚è‹¥è¯¥å‚æ•°è®¾ç½®ä¸ºFalseï¼Œåˆ™åœ¨è®­ç»ƒä¹‹å‰å¯¹æ‰€æœ‰çš„æ•°æ®é›†æ ·æœ¬è¿›è¡Œtokenizeï¼ˆå¤šæ¨¡æ€æ¨¡å‹åˆ™åŒ…æ‹¬ä»ç£ç›˜ä¸­è¯»å–å›¾ç‰‡ï¼‰ã€‚è¯¥å‚æ•°åœ¨LLMè®­ç»ƒä¸­é»˜è®¤è®¾ç½®ä¸ºFalseï¼Œè€ŒMLLMè®­ç»ƒé»˜è®¤ä¸ºTrueï¼ŒèŠ‚çº¦å†…å­˜
- acc_strategy: è®­ç»ƒå’ŒéªŒè¯æ—¶è®¡ç®—accçš„ç­–ç•¥ã€‚å¯é€‰ä¸º`seq`å’Œ`token`çº§åˆ«çš„accï¼Œé»˜è®¤ä¸º`token`
- max_new_tokens: è¦†ç›–ç”Ÿæˆå‚æ•°ã€‚predict_with_generate=Trueæ—¶çš„æœ€å¤§ç”Ÿæˆtokenæ•°é‡ï¼Œé»˜è®¤64
- temperature: è¦†ç›–ç”Ÿæˆå‚æ•°ã€‚predict_with_generate=Trueæ—¶çš„temperatureï¼Œé»˜è®¤0
- optimizer: pluginçš„è‡ªå®šä¹‰optimizeråç§°ï¼Œé»˜è®¤ä¸ºNone
- metric: pluginçš„è‡ªå®šä¹‰metricåç§°ã€‚é»˜è®¤ä¸ºNoneï¼Œå³åœ¨predict_with_generate=Falseçš„æƒ…å†µä¸‹è®¾ç½®ä¸º'acc'ï¼Œåœ¨predict_with_generate=Trueçš„æƒ…å†µä¸‹è®¾ç½®ä¸º'nlg'
- eval_use_evalscope: æ˜¯å¦ä½¿ç”¨evalscopeè¿›è¡Œè®­ç»ƒæ—¶è¯„æµ‹ï¼Œéœ€è¦è®¾ç½®è¯¥å‚æ•°æ¥å¼€å¯è¯„æµ‹ï¼Œå…·ä½“ä½¿ç”¨å‚è€ƒ[ç¤ºä¾‹](../Instruction/è¯„æµ‹.md#è®­ç»ƒä¸­è¯„æµ‹)
- eval_datasets: è¯„æµ‹æ•°æ®é›†ï¼Œå¯è®¾ç½®å¤šä¸ªæ•°æ®é›†ï¼Œç”¨ç©ºæ ¼åˆ†å‰²
- eval_datasets_args: è¯„æµ‹æ•°æ®é›†å‚æ•°ï¼Œjsonæ ¼å¼ï¼Œå¯è®¾ç½®å¤šä¸ªæ•°æ®é›†çš„å‚æ•°
- eval_limit: è¯„æµ‹æ•°æ®é›†é‡‡æ ·æ•°
- eval_generation_config: è¯„æµ‹æ—¶æ¨¡å‹æ¨ç†é…ç½®ï¼Œjsonæ ¼å¼ï¼Œé»˜è®¤ä¸º`{'max_tokens': 512}`

### RLHFå‚æ•°
RLHFå‚æ•°ç»§æ‰¿äº[è®­ç»ƒå‚æ•°](#è®­ç»ƒå‚æ•°)

- ğŸ”¥rlhf_type: äººç±»å¯¹é½ç®—æ³•ç±»å‹ï¼Œæ”¯æŒ`dpo`ã€`orpo`ã€`simpo`ã€`kto`ã€`cpo`ã€`rm`ã€`ppo`å’Œ`grpo`ã€‚é»˜è®¤ä¸º'dpo'
- ref_model: é‡‡ç”¨dpoã€ktoã€ppoã€grpoç®—æ³•ä¸”ä½¿ç”¨å…¨å‚æ•°è®­ç»ƒæ—¶éœ€è¦ä¼ å…¥ã€‚é»˜è®¤ä¸ºNone
- ref_model_type: åŒmodel_typeã€‚é»˜è®¤ä¸ºNone
- ref_model_revision: åŒmodel_revisionã€‚é»˜è®¤ä¸ºNone
- ğŸ”¥beta: KLæ­£åˆ™é¡¹ç³»æ•°ï¼Œé»˜è®¤ä¸º`None`ï¼Œå³`simpo`ç®—æ³•é»˜è®¤ä¸º`2.`ï¼ŒGRPOé»˜è®¤ä¸º`0.04`ï¼Œå…¶ä»–ç®—æ³•é»˜è®¤ä¸º`0.1`ã€‚å…·ä½“å‚è€ƒ[æ–‡æ¡£](./äººç±»å¯¹é½.md)
- label_smoothing: æ˜¯å¦ä½¿ç”¨DPO smoothingï¼Œé»˜è®¤å€¼ä¸º`0`
- ğŸ”¥rpo_alpha: æ§åˆ¶DPOä¸­åŠ å…¥sft_lossçš„æƒé‡ï¼Œé»˜è®¤ä¸º`1`ã€‚æœ€åçš„lossä¸º`KL_loss + rpo_alpha * sft_loss`
- cpo_alpha: CPO/SimPO loss ä¸­ nll lossçš„ç³»æ•°, é»˜è®¤ä¸º`1.`
- simpo_gamma: SimPOç®—æ³•ä¸­çš„reward marginé¡¹ï¼Œè®ºæ–‡å»ºè®®è®¾ç½®ä¸º0.5-1.5ï¼Œé»˜è®¤ä¸º`1.`
- desirable_weight: KTOç®—æ³•ä¸­å¯¹desirable responseçš„lossæƒé‡ $\lambda_D$ï¼Œé»˜è®¤ä¸º`1.`
- undesirable_weight: KTOç®—æ³•ä¸­å¯¹undesirable responseçš„lossæƒé‡ $\lambda_U$ï¼Œé»˜è®¤ä¸º`1.`
- loss_scale: è¦†ç›–æ¨¡æ¿å‚æ•°ï¼Œé»˜è®¤ä¸º'last_round'
- temperature: é»˜è®¤ä¸º0.9ï¼Œè¯¥å‚æ•°å°†åœ¨PPOã€GRPOä¸­ä½¿ç”¨

#### Rewardæ¨¡å‹å‚æ•°
rewardæ¨¡å‹å‚æ•°å°†åœ¨PPOã€GRPOä¸­ä½¿ç”¨ã€‚

- reward_model: é»˜è®¤ä¸ºNone
- reward_adapters: é»˜è®¤ä¸º`[]`
- reward_model_type: é»˜è®¤ä¸ºNone
- reward_model_revision: é»˜è®¤ä¸ºNone

#### PPOå‚æ•°

ä»¥ä¸‹å‚æ•°å«ä¹‰å¯ä»¥å‚è€ƒ[è¿™é‡Œ](https://huggingface.co/docs/trl/main/ppo_trainer)
- num_ppo_epochs: é»˜è®¤ä¸º4
- whiten_rewards: é»˜è®¤ä¸ºFalse
- kl_coef: é»˜è®¤ä¸º0.05
- cliprange: é»˜è®¤ä¸º0.2
- vf_coef: é»˜è®¤ä¸º0.1
- cliprange_value: é»˜è®¤ä¸º0.2
- gamma: é»˜è®¤ä¸º1.0
- lam: é»˜è®¤ä¸º0.95
- num_mini_batches: é»˜è®¤ä¸º1
- local_rollout_forward_batch_size: é»˜è®¤ä¸º64
- num_sample_generations: é»˜è®¤ä¸º10
- response_length: é»˜è®¤ä¸º512
- missing_eos_penalty: é»˜è®¤ä¸ºNone


#### GRPOå‚æ•°
- num_generations: GRPOç®—æ³•ä¸­çš„Gå€¼ï¼Œé»˜è®¤ä¸º8
- max_completion_length: GRPOç®—æ³•ä¸­çš„æœ€å¤§ç”Ÿæˆé•¿åº¦ï¼Œé»˜è®¤ä¸º512
- ds3_gather_for_generation: è¯¥å‚æ•°é€‚ç”¨äºDeepSpeed ZeRO-3ã€‚å¦‚æœå¯ç”¨ï¼Œç­–ç•¥æ¨¡å‹æƒé‡å°†è¢«æ”¶é›†ç”¨äºç”Ÿæˆï¼Œä»è€Œæé«˜ç”Ÿæˆé€Ÿåº¦ã€‚ç„¶è€Œï¼Œç¦ç”¨æ­¤é€‰é¡¹å…è®¸è®­ç»ƒè¶…å‡ºå•ä¸ªGPU VRAMçš„æ¨¡å‹ï¼Œå°½ç®¡ç”Ÿæˆé€Ÿåº¦ä¼šå˜æ…¢ã€‚ç¦ç”¨æ­¤é€‰é¡¹ä¸vLLMç”Ÿæˆä¸å…¼å®¹ã€‚é»˜è®¤ä¸ºTrue
- reward_funcs: GRPOç®—æ³•å¥–åŠ±å‡½æ•°ï¼Œå¯é€‰é¡¹ä¸º`accuracy`ã€`format`ã€`cosine` å’Œ `repetition`ï¼Œè§swift/plugin/orm.pyã€‚ä½ ä¹Ÿå¯ä»¥åœ¨pluginä¸­è‡ªå®šä¹‰è‡ªå·±çš„å¥–åŠ±å‡½æ•°ã€‚é»˜è®¤ä¸º`[]`
- reward_weights: æ¯ä¸ªå¥–åŠ±å‡½æ•°çš„æƒé‡ã€‚å¿…é¡»ä¸å¥–åŠ±å‡½æ•°çš„æ•°é‡åŒ¹é…ã€‚å¦‚æœä¸º Noneï¼Œåˆ™æ‰€æœ‰å¥–åŠ±çš„æƒé‡éƒ½ç›¸ç­‰ï¼Œä¸º`1.0`
  - æç¤ºï¼šå¦‚æœGRPOè®­ç»ƒä¸­åŒ…å«`--reward_model`ï¼Œåˆ™å…¶åŠ åœ¨å¥–åŠ±å‡½æ•°çš„æœ€åä½ç½®
- log_completions: æ˜¯å¦è®°å½•è®­ç»ƒä¸­çš„æ¨¡å‹ç”Ÿæˆå†…å®¹ï¼Œæ­é… `--report_to wandb` ä½¿ç”¨ã€‚é»˜è®¤ä¸ºFalse
  - æç¤ºï¼šè‹¥æ²¡æœ‰è®¾ç½®`--report_to wandb`ï¼Œåˆ™ä¼šåœ¨checkpointä¸­åˆ›å»º`completions.jsonl`æ¥å­˜å‚¨ç”Ÿæˆå†…å®¹
- use_vllm: æ˜¯å¦ä½¿ç”¨vLLMä½œä¸ºGRPOç”Ÿæˆçš„infer_backendï¼Œé»˜è®¤ä¸ºFalse
- num_infer_workers: æ¯ä¸ªnodeä¸Šæ¨ç†workeræ•°é‡ï¼Œä»…å¯¹vllmæˆ–è€…lmdeployæ—¶æœ‰æ•ˆ
- vllm_device: è®¾ç½®vLLMéƒ¨ç½²çš„è®¾å¤‡ï¼Œå¯ä»¥è®¾ç½®ä¸º`auto`ï¼Œä»£è¡¨æŒ‰ç…§num_infer_workersæ•°é‡ä½¿ç”¨æœ€åçš„å‡ å¼ å¡ï¼Œå¦åˆ™è¯·ä¼ å…¥å’Œnum_infer_workersç›¸ç­‰æ•°é‡çš„è®¾å¤‡ï¼Œä¾‹å¦‚`--vllm_device cuda:1 cuda:2`
- vllm_gpu_memory_utilization: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸º0.9
- vllm_max_model_len: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸ºNone
- vllm_max_num_seqs: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸º256
- vllm_enforce_eager: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸ºFalse
- vllm_limit_mm_per_prompt: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸ºNone
- vllm_enable_prefix_caching: vllmé€ä¼ å‚æ•°ï¼Œé»˜è®¤ä¸ºTrue
- top_k: é»˜è®¤ä¸º50
- top_p: é»˜è®¤ä¸º0.9
- repetition_penalty: é‡å¤æƒ©ç½šé¡¹ã€‚é»˜è®¤ä¸º1.
- num_iterations: æ¯ä¸ªæ‰¹æ¬¡ä»£æ›´æ–°æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1.
- epsilon: clip ç³»æ•°.
- async_generate: å¼‚æ­¥rolloutä»¥æé«˜è®­ç»ƒé€Ÿåº¦ï¼Œé»˜è®¤`false`.
- sleep_level: vllmç‰¹æœ‰å‚æ•°ï¼Œåœ¨è®­ç»ƒå’Œrolloutå¤ç”¨å¡çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©vllmè¿›è¡Œoffload.
- move_model_batches: åœ¨æ¨¡å‹å‘vLLM/LMDeployç­‰å¿«é€Ÿæ¨ç†æ¡†æ¶ç§»åŠ¨å‚æ•°æ—¶ï¼Œå°†layersåˆ†ä¸ºå¤šå°‘ä¸ªbatch. é»˜è®¤ä¸ºNone, ä»£è¡¨æ•´ä¸ªæ¨¡å‹ä¸è¿›è¡Œæ‹†åˆ†ï¼Œå¦åˆ™æ‹†åˆ†ä¸ºmove_model_batches+1(élayerå‚æ•°)+1(å¤šæ¨¡æ€éƒ¨åˆ†å‚æ•°)ä¸ª
- offload_optimizer: æ˜¯å¦åœ¨vLLM/LMDeployæ¨ç†æ—¶offload optimizerå‚æ•°ï¼Œé»˜è®¤ä¸ºFalse
- offload_model: æ˜¯å¦åœ¨vLLM/LMDeployæ¨ç†æ—¶offload æ¨¡å‹æœ¬èº«ï¼Œé»˜è®¤ä¸ºFalse
- gc_collect_after_offload: æ˜¯å¦åœ¨offloadç»“æŸæ—¶è¿›è¡Œgcï¼ˆpython gcå’ŒGPU gcï¼‰ï¼Œé»˜è®¤ä¸ºFalse

cosine å¥–åŠ±å‚æ•°
- cosine_min_len_value_wrongï¼šcosine å¥–åŠ±å‡½æ•°å‚æ•°ï¼Œç”Ÿæˆé”™è¯¯ç­”æ¡ˆæ—¶ï¼Œæœ€å°é•¿åº¦å¯¹åº”çš„å¥–åŠ±å€¼ã€‚é»˜è®¤å€¼ä¸º0.0
- cosine_max_len_value_wrongï¼šç”Ÿæˆé”™è¯¯ç­”æ¡ˆæ—¶ï¼Œæœ€å¤§é•¿åº¦å¯¹åº”çš„å¥–åŠ±å€¼ã€‚é»˜è®¤å€¼ä¸º-0.5
- cosine_min_len_value_correctï¼šç”Ÿæˆæ­£ç¡®ç­”æ¡ˆæ—¶ï¼Œæœ€å°é•¿åº¦å¯¹åº”çš„å¥–åŠ±å€¼ã€‚é»˜è®¤å€¼ä¸º1.0
- cosine_max_len_value_correctï¼šç”Ÿæˆæ­£ç¡®ç­”æ¡ˆæ—¶ï¼Œæœ€å¤§é•¿åº¦å¯¹åº”çš„å¥–åŠ±å€¼ã€‚é»˜è®¤å€¼ä¸º0.5
- cosine_max_lenï¼šç”Ÿæˆæ–‡æœ¬çš„æœ€å¤§é•¿åº¦é™åˆ¶ã€‚é»˜è®¤ç­‰äº max_completion_length

repetition å¥–åŠ±å‚æ•°
- repetition_n_gramsï¼šç”¨äºæ£€æµ‹é‡å¤çš„ n-gram å¤§å°ã€‚é»˜è®¤å€¼ä¸º3
- repetition_max_penaltyï¼šæœ€å¤§æƒ©ç½šå€¼ï¼Œç”¨äºæ§åˆ¶æƒ©ç½šçš„å¼ºåº¦ã€‚é»˜è®¤å€¼ä¸º-1.0

#### SWANLAB

- swanlab_token: SwanLabçš„api-key
- swanlab_project: swanlabçš„projectï¼Œéœ€è¦åœ¨é¡µé¢ä¸­é¢„å…ˆåˆ›å»ºå¥½:[https://swanlab.cn/space/~](https://swanlab.cn/space/~)
- swanlab_workspace: é»˜è®¤ä¸ºNoneï¼Œä¼šä½¿ç”¨api-keyå¯¹åº”çš„username
- swanlab_exp_name: å®éªŒåï¼Œå¯ä»¥ä¸ºç©ºï¼Œä¸ºç©ºæ—¶é»˜è®¤ä¼ å…¥--output_dirçš„å€¼
- swanlab_mode: å¯é€‰cloudå’Œlocalï¼Œäº‘æ¨¡å¼æˆ–è€…æœ¬åœ°æ¨¡å¼

### æ¨ç†å‚æ•°

æ¨ç†å‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)ã€[åˆå¹¶å‚æ•°](#åˆå¹¶å‚æ•°)ã€[vLLMå‚æ•°](#vllmå‚æ•°)ã€[LMDeployå‚æ•°](#LMDeployå‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†ï¼š

- ğŸ”¥infer_backend: æ¨ç†åŠ é€Ÿåç«¯ï¼Œæ”¯æŒ'pt'ã€'vllm'ã€'lmdeploy'ä¸‰ç§æ¨ç†å¼•æ“ã€‚é»˜è®¤ä¸º'pt'
- ğŸ”¥max_batch_size: æŒ‡å®šinfer_backendä¸ºptæ—¶ç”Ÿæ•ˆï¼Œç”¨äºæ‰¹é‡æ¨ç†ï¼Œé»˜è®¤ä¸º1
- ddp_backend: æŒ‡å®šinfer_backendä¸ºptæ—¶ç”Ÿæ•ˆï¼Œç”¨äºæŒ‡å®šå¤šå¡æ¨ç†æ—¶çš„åˆ†å¸ƒå¼åç«¯ï¼Œé»˜è®¤ä¸ºNoneï¼Œè¿›è¡Œè‡ªåŠ¨é€‰æ‹©ã€‚å¤šå¡æ¨ç†ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/infer/pt)
- ğŸ”¥result_path: æ¨ç†ç»“æœå­˜å‚¨è·¯å¾„ï¼ˆjsonlï¼‰ï¼Œé»˜è®¤ä¸ºNoneï¼Œä¿å­˜åœ¨checkpointç›®å½•ï¼ˆå«args.jsonæ–‡ä»¶ï¼‰æˆ–è€…'./result'ç›®å½•ï¼Œæœ€ç»ˆå­˜å‚¨è·¯å¾„ä¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰“å°
- metric: å¯¹æ¨ç†çš„ç»“æœè¿›è¡Œè¯„ä¼°ï¼Œç›®å‰æ”¯æŒ'acc'å’Œ'rouge'ã€‚é»˜è®¤ä¸ºNoneï¼Œå³ä¸è¿›è¡Œè¯„ä¼°
- val_dataset_sample: æ¨ç†æ•°æ®é›†é‡‡æ ·æ•°ï¼Œé»˜è®¤ä¸ºNone


### éƒ¨ç½²å‚æ•°

éƒ¨ç½²å‚æ•°ç»§æ‰¿äº[æ¨ç†å‚æ•°](#æ¨ç†å‚æ•°)

- host: æœåŠ¡hostï¼Œé»˜è®¤ä¸º'0.0.0.0'
- port: ç«¯å£å·ï¼Œé»˜è®¤ä¸º8000
- api_key: è®¿é—®éœ€è¦ä½¿ç”¨çš„api_keyï¼Œé»˜è®¤ä¸ºNone
- owned_by: é»˜è®¤ä¸º`swift`
- ğŸ”¥served_model_name: æä¾›æœåŠ¡çš„æ¨¡å‹åç§°ï¼Œé»˜è®¤ä½¿ç”¨modelçš„åç¼€
- verbose: æ‰“å°è¯¦ç»†æ—¥å¿—ï¼Œé»˜è®¤ä¸ºTrue
  - æ³¨æ„ï¼šåœ¨`swift app`æˆ–è€…`swift eval`æ—¶ï¼Œé»˜è®¤ä¸ºFalse
- log_interval: tokens/sç»Ÿè®¡å€¼æ‰“å°é—´éš”ï¼Œé»˜è®¤20ç§’ã€‚è®¾ç½®ä¸º-1åˆ™ä¸æ‰“å°
- max_logprobs: æœ€å¤šè¿”å›å®¢æˆ·ç«¯çš„logprobsæ•°é‡ï¼Œé»˜è®¤ä¸º20


### Web-UIå‚æ•°
- server_name: web-uiçš„hostï¼Œé»˜è®¤ä¸º'0.0.0.0'
- server_port: web-uiçš„portï¼Œé»˜è®¤ä¸º7860
- share: é»˜è®¤ä¸ºFalse
- lang: web-uiçš„è¯­è¨€ï¼Œå¯é€‰ä¸º'zh', 'en'ã€‚é»˜è®¤ä¸º'zh'


### Appå‚æ•°

Appå‚æ•°ç»§æ‰¿äº[éƒ¨ç½²å‚æ•°](#éƒ¨ç½²å‚æ•°), [Web-UIå‚æ•°](#Web-UIå‚æ•°)
- base_url: æ¨¡å‹éƒ¨ç½²çš„base_urlï¼Œä¾‹å¦‚`http://localhost:8000/v1`ã€‚é»˜è®¤ä¸º`None`ï¼Œä½¿ç”¨æœ¬åœ°éƒ¨ç½²
- studio_title: studioçš„æ ‡é¢˜ã€‚é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸ºæ¨¡å‹å
- is_multimodal: æ˜¯å¦å¯åŠ¨å¤šæ¨¡æ€ç‰ˆæœ¬çš„appã€‚é»˜è®¤ä¸ºNoneï¼Œè‡ªåŠ¨æ ¹æ®modelåˆ¤æ–­ï¼Œè‹¥æ— æ³•åˆ¤æ–­ï¼Œè®¾ç½®ä¸ºFalse
- lang: è¦†ç›–Web-UIå‚æ•°ï¼Œé»˜è®¤ä¸º'en'

### è¯„æµ‹å‚æ•°

è¯„æµ‹å‚æ•°ç»§æ‰¿äº[éƒ¨ç½²å‚æ•°](#éƒ¨ç½²å‚æ•°)

- ğŸ”¥eval_backend: è¯„æµ‹åç«¯ï¼Œé»˜è®¤ä¸º'Native'ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸º'OpenCompass'æˆ–'VLMEvalKit'
- ğŸ”¥eval_dataset: è¯„æµ‹æ•°æ®é›†ï¼Œè¯·æŸ¥çœ‹[è¯„æµ‹æ–‡æ¡£](./è¯„æµ‹.md)
- eval_limit: æ¯ä¸ªè¯„æµ‹é›†çš„é‡‡æ ·æ•°ï¼Œé»˜è®¤ä¸ºNone
- eval_output_dir: è¯„æµ‹å­˜å‚¨ç»“æœçš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º'eval_output'
- ğŸ”¥local_dataset: éƒ¨åˆ†è¯„æµ‹é›†ï¼Œå¦‚`CMB`æ— æ³•ç›´æ¥è¿è¡Œï¼Œéœ€è¦ä¸‹è½½é¢å¤–æ•°æ®åŒ…æ‰å¯ä»¥ä½¿ç”¨ã€‚è®¾ç½®æœ¬å‚æ•°ä¸º`true`å¯ä»¥è‡ªåŠ¨ä¸‹è½½å…¨é‡æ•°æ®åŒ…ï¼Œå¹¶åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º`data`æ–‡ä»¶å¤¹å¹¶å¼€å§‹è¯„æµ‹ã€‚æ•°æ®åŒ…ä»…ä¼šä¸‹è½½ä¸€æ¬¡ï¼Œåç»­ä¼šä½¿ç”¨ç¼“å­˜ã€‚è¯¥å‚æ•°é»˜è®¤ä¸º`false`ã€‚
  - æ³¨æ„ï¼šé»˜è®¤è¯„æµ‹ä¼šä½¿ç”¨`~/.cache/opencompass`ä¸‹çš„æ•°æ®é›†ï¼Œåœ¨æŒ‡å®šæœ¬å‚æ•°åä¼šç›´æ¥ä½¿ç”¨å½“å‰ç›®å½•ä¸‹çš„dataæ–‡ä»¶å¤¹
- temperature: è¦†ç›–ç”Ÿæˆå‚æ•°ï¼Œé»˜è®¤ä¸º0
- eval_num_proc: è¯„æµ‹æ—¶å®¢æˆ·ç«¯æœ€å¤§å¹¶å‘æ•°ï¼Œé»˜è®¤ä¸º16
- ğŸ”¥eval_url: è¯„æµ‹urlï¼Œä¾‹å¦‚`http://localhost:8000/v1`ã€‚ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/eval/eval_url)ã€‚é»˜è®¤ä¸ºNoneï¼Œé‡‡ç”¨æœ¬åœ°éƒ¨ç½²è¯„ä¼°

### å¯¼å‡ºå‚æ•°

å¯¼å‡ºå‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)å’Œ[åˆå¹¶å‚æ•°](#åˆå¹¶å‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†:

- ğŸ”¥output_dir: å¯¼å‡ºç»“æœå­˜å‚¨è·¯å¾„ã€‚é»˜è®¤ä¸ºNoneï¼Œä¼šè‡ªåŠ¨è®¾ç½®åˆé€‚åç¼€çš„è·¯å¾„
- exist_ok: å¦‚æœoutput_dirå­˜åœ¨ï¼Œä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè¿›è¡Œè¦†ç›–ã€‚é»˜è®¤ä¸ºFalse
- ğŸ”¥quant_method: å¯é€‰ä¸º'gptq'ã€'awq'ã€'bnb'ï¼Œé»˜è®¤ä¸ºNoneã€‚ä¾‹å­å‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/export/quantize)
- quant_n_samples: gptq/awqçš„æ ¡éªŒé›†é‡‡æ ·æ•°ï¼Œé»˜è®¤ä¸º256
- max_length: æ ¡å‡†é›†çš„max_length, é»˜è®¤å€¼2048
- quant_batch_size: é‡åŒ–batch_sizeï¼Œé»˜è®¤ä¸º1
- group_size: é‡åŒ–groupå¤§å°ï¼Œé»˜è®¤ä¸º128
- to_ollama: äº§ç”Ÿollamaæ‰€éœ€çš„Modelfileæ–‡ä»¶ã€‚é»˜è®¤ä¸ºFalse
- ğŸ”¥to_mcore: HFæ ¼å¼æƒé‡è½¬æˆMegatronæ ¼å¼ã€‚é»˜è®¤ä¸ºFalse
- to_hf: Megatronæ ¼å¼æƒé‡è½¬æˆHFæ ¼å¼ã€‚é»˜è®¤ä¸ºFalse
- mcore_model: mcoreæ ¼å¼æ¨¡å‹è·¯å¾„ã€‚é»˜è®¤ä¸ºNone
- test_convert_precision: æµ‹è¯•HFå’ŒMegatronæ ¼å¼æƒé‡è½¬æ¢çš„ç²¾åº¦è¯¯å·®ã€‚é»˜è®¤ä¸ºFalse
- ğŸ”¥push_to_hub: æ˜¯å¦æ¨é€hubï¼Œé»˜è®¤ä¸ºFalseã€‚ä¾‹å­å‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/export/push_to_hub.sh)
- hub_model_id: æ¨é€çš„model_idï¼Œé»˜è®¤ä¸ºNone
- hub_private_repo: æ˜¯å¦æ˜¯private repoï¼Œé»˜è®¤ä¸ºFalse
- commit_message: æäº¤ä¿¡æ¯ï¼Œé»˜è®¤ä¸º'update files'

### é‡‡æ ·å‚æ•°

- prm_model: è¿‡ç¨‹å¥–åŠ±æ¨¡å‹çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯æ¨¡å‹idï¼ˆä»¥ptæ–¹å¼æ‹‰èµ·ï¼‰ï¼Œæˆ–è€…pluginä¸­å®šä¹‰çš„prm keyï¼ˆè‡ªå®šä¹‰æ¨ç†è¿‡ç¨‹ï¼‰
- orm_model: ç»“æœå¥–åŠ±æ¨¡å‹çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯é€šé…ç¬¦æˆ–æµ‹è¯•ç”¨ä¾‹ç­‰ï¼Œä¸€èˆ¬å®šä¹‰åœ¨pluginä¸­
- sampler_typeï¼šé‡‡æ ·ç±»å‹ï¼Œç›®å‰æ”¯æŒ sample, mctsï¼Œæœªæ¥ä¼šæ”¯æŒ dvts
- sampler_engineï¼šæ”¯æŒ`pt`, `lmdeploy`, `vllm`, `client`, `no`ï¼Œé»˜è®¤ä¸º`pt`ï¼Œé‡‡æ ·æ¨¡å‹çš„æ¨ç†å¼•æ“
- sampler_typeï¼šé‡‡æ ·ç±»å‹ï¼Œç›®å‰æ”¯æŒsampleï¼ˆdo_sampleæ–¹å¼ï¼‰ï¼Œæœªæ¥ä¼šæ”¯æŒmctså’Œdvts
- sampler_engineï¼šæ”¯æŒ`pt`, `lmdeploy`, `vllm`, `no`ï¼Œé»˜è®¤ä¸º`pt`ï¼Œé‡‡æ ·æ¨¡å‹çš„æ¨ç†å¼•æ“
- output_dirï¼šè¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸º`sample_output`
- output_fileï¼šè¾“å‡ºæ–‡ä»¶åç§°ï¼Œé»˜è®¤ä¸º`None`ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºæ–‡ä»¶åã€‚ä¼ å…¥æ—¶ä¸éœ€è¦ä¼ å…¥ç›®å½•ï¼Œä»…æ”¯æŒjsonlæ ¼å¼
- override_exist_fileï¼šå¦‚`output_file`å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–
- num_sampling_per_gpu_batch_sizeï¼šæ¯æ¬¡é‡‡æ ·çš„batch_size
- num_sampling_per_gpu_batchesï¼šå…±é‡‡æ ·å¤šå°‘batch
- n_best_to_keepï¼šè¿”å›å¤šå°‘æœ€ä½³sequences
- data_rangeï¼šæœ¬é‡‡æ ·å¤„ç†æ•°æ®é›†çš„åˆ†ç‰‡ã€‚ä¼ å…¥æ ¼å¼ä¸º`2 3`ï¼Œä»£è¡¨æ•°æ®é›†åˆ†ä¸º3ä»½å¤„ç†ï¼ˆè¿™æ„å‘³ç€é€šå¸¸æœ‰ä¸‰ä¸ª`swift sample`åœ¨å¹¶è¡Œå¤„ç†ï¼‰ï¼Œæœ¬å®ä¾‹æ­£åœ¨å¤„ç†ç¬¬3ä¸ªåˆ†ç‰‡
- temperatureï¼šåœ¨è¿™é‡Œé»˜è®¤ä¸º1.0
- prm_thresholdï¼šPRMé˜ˆå€¼ï¼Œä½äºè¯¥é˜ˆå€¼çš„ç»“æœä¼šè¢«è¿‡æ»¤æ‰ï¼Œé»˜è®¤å€¼ä¸º`0`
- easy_query_thresholdï¼šå•ä¸ªqueryçš„æ‰€æœ‰é‡‡æ ·ä¸­ï¼ŒORMè¯„ä¼°å¦‚æœæ­£ç¡®ï¼Œå¤§äºè¯¥æ¯”ä¾‹çš„queryä¼šè¢«ä¸¢å¼ƒï¼Œé˜²æ­¢è¿‡äºç®€å•çš„queryå‡ºç°åœ¨ç»“æœä¸­ï¼Œé»˜è®¤ä¸º`None`ï¼Œä»£è¡¨ä¸è¿‡æ»¤
- engine_kwargsï¼šä¼ å…¥sampler_engineçš„é¢å¤–å‚æ•°ï¼Œä»¥json stringä¼ å…¥ï¼Œä¾‹å¦‚`{"cache_max_entry_count":0.7}`
- num_return_sequencesï¼šé‡‡æ ·è¿”å›çš„åŸå§‹sequenceæ•°é‡ã€‚é»˜è®¤ä¸º64ï¼Œæœ¬å‚æ•°å¯¹`sample`é‡‡æ ·æœ‰æ•ˆ
- cache_filesï¼šä¸ºé¿å…åŒæ—¶åŠ è½½prmå’Œgeneratoré€ æˆæ˜¾å­˜OOMï¼Œå¯ä»¥åˆ†ä¸¤æ­¥è¿›è¡Œé‡‡æ ·ï¼Œç¬¬ä¸€æ­¥å°†prmå’Œormç½®ä¸º`None`ï¼Œåˆ™æ‰€æœ‰ç»“æœéƒ½ä¼šè¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œç¬¬äºŒæ¬¡è¿è¡Œé‡‡æ ·å°†sampler_engineç½®ä¸º`no`å¹¶ä¼ å…¥`--cache_files`ä¸ºä¸Šæ¬¡é‡‡æ ·çš„è¾“å‡ºæ–‡ä»¶ï¼Œåˆ™ä¼šä½¿ç”¨ä¸Šæ¬¡è¾“å‡ºçš„ç»“æœè¿›è¡Œprmå’Œormè¯„ä¼°å¹¶è¾“å‡ºæœ€ç»ˆç»“æœã€‚
  - æ³¨æ„ï¼šä½¿ç”¨cache_filesæ—¶ï¼Œ`--dataset`ä»ç„¶éœ€è¦ä¼ å…¥ï¼Œè¿™æ˜¯å› ä¸ºcache_filesçš„idæ˜¯ç”±åŸå§‹æ•°æ®è®¡ç®—çš„md5ï¼Œéœ€è¦æŠŠä¸¤éƒ¨åˆ†ä¿¡æ¯ç»“åˆä½¿ç”¨ã€‚

#### MCTS
- rollout_depthï¼šrollout æ—¶çš„æœ€å¤§æ·±åº¦ï¼Œé»˜è®¤ä¸º `5`
- rollout_start_depthï¼šå¼€å§‹ rollout æ—¶çš„æ·±åº¦ï¼Œä½äºæ­¤æ·±åº¦çš„èŠ‚ç‚¹åªä¼šè¿›è¡Œ expand æ“ä½œï¼Œé»˜è®¤ä¸º `3`
- max_iterationsï¼šmcts çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º `100`
- process_reward_rateï¼šselect ä¸­è®¡ç®— value æ—¶ process reward å çš„æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º `0.0`ï¼Œå³ä¸ä½¿ç”¨ PRM
- exploration_rateï¼šUCT ç®—æ³•ä¸­çš„æ¢ç´¢å‚æ•°ï¼Œå€¼è¶Šå¤§è¶Šç…§é¡¾æ¢ç´¢æ¬¡æ•°è¾ƒå°çš„èŠ‚ç‚¹ï¼Œé»˜è®¤ä¸º `0.5`
- api_keyï¼šä½¿ç”¨ client ä½œä¸ºæ¨ç†å¼•æ“æ—¶éœ€è¦ï¼Œé»˜è®¤ä¸º `EMPTY`
- base_urlï¼šä½¿ç”¨ client ä½œä¸ºæ¨ç†å¼•æ“æ—¶éœ€è¦ï¼Œé»˜è®¤ä¸º 'https://dashscope.aliyuncs.com/compatible-mode/v1'


## ç‰¹å®šæ¨¡å‹å‚æ•°
ç‰¹å®šæ¨¡å‹å‚æ•°å¯ä»¥é€šè¿‡`--model_kwargs`æˆ–è€…ç¯å¢ƒå˜é‡è¿›è¡Œè®¾ç½®ï¼Œä¾‹å¦‚: `--model_kwargs '{"fps_max_frames": 12}'`æˆ–è€…`FPS_MAX_FRAMES=12`

### qwen2_vl, qvq, qwen2_5_vl
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/QwenLM/Qwen2-VL/blob/main/qwen-vl-utils/src/qwen_vl_utils/vision_process.py#L24)

- IMAGE_FACTOR: é»˜è®¤ä¸º28
- MIN_PIXELS: é»˜è®¤ä¸º`4 * 28 * 28`
- ğŸ”¥MAX_PIXELS: é»˜è®¤ä¸º`16384 * 28 * 28`ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/ocr.sh#L3)
- MAX_RATIO: é»˜è®¤ä¸º200
- VIDEO_MIN_PIXELS: é»˜è®¤ä¸º`128 * 28 * 28`
- ğŸ”¥VIDEO_MAX_PIXELS: é»˜è®¤ä¸º`768 * 28 * 28`ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/video.sh#L7)
- VIDEO_TOTAL_PIXELS: é»˜è®¤ä¸º`24576 * 28 * 28`
- FRAME_FACTOR: é»˜è®¤ä¸º2
- FPS: é»˜è®¤ä¸º2.0
- FPS_MIN_FRAMES: é»˜è®¤ä¸º4
- ğŸ”¥FPS_MAX_FRAMES: é»˜è®¤ä¸º768ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/video.sh#L8)

### qwen2_audio
- SAMPLING_RATE: é»˜è®¤ä¸º16000

### internvl, internvl_phi3
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/models/OpenGVLab/Mini-InternVL-Chat-2B-V1-5)
- MAX_NUM: é»˜è®¤ä¸º12
- INPUT_SIZE: é»˜è®¤ä¸º448

### internvl2, internvl2_phi3, internvl2_5
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/models/OpenGVLab/InternVL2_5-2B)
- MAX_NUM: é»˜è®¤ä¸º12
- INPUT_SIZE: é»˜è®¤ä¸º448
- VIDEO_MAX_NUM: é»˜è®¤ä¸º1ã€‚è§†é¢‘çš„MAX_NUM
- VIDEO_SEGMENTS: é»˜è®¤ä¸º8


### minicpmv2_6, minicpmo2_6
- MAX_SLICE_NUMS: é»˜è®¤ä¸º9ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6/file/view/master?fileName=config.json&status=1)
- VIDEO_MAX_SLICE_NUMS: é»˜è®¤ä¸º1ï¼Œè§†é¢‘çš„MAX_SLICE_NUMSï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6)
- MAX_NUM_FRAMES: é»˜è®¤ä¸º64ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6)

### minicpmo2_6
- INIT_TTS: é»˜è®¤ä¸ºFalse
- INIT_AUDIO: é»˜è®¤ä¸ºFalse

### ovis1_6, ovis2
- MAX_PARTITION: é»˜è®¤ä¸º9ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/AIDC-AI/Ovis/blob/d248e34d755a95d24315c40e2489750a869c5dbc/ovis/model/modeling_ovis.py#L312)

### mplug_owl3, mplug_owl3_241101
- MAX_NUM_FRAMES: é»˜è®¤ä¸º16ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/iic/mPLUG-Owl3-7B-240728)

### xcomposer2_4khd
- HD_NUM: é»˜è®¤ä¸º55ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/Shanghai_AI_Laboratory/internlm-xcomposer2-4khd-7b)

### xcomposer2_5
- HD_NUM: å›¾ç‰‡æ•°é‡ä¸º1æ—¶ï¼Œé»˜è®¤å€¼ä¸º24ã€‚å¤§äº1ï¼Œé»˜è®¤ä¸º6ã€‚å‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/AI-ModelScope/internlm-xcomposer2d5-7b/file/view/master?fileName=modeling_internlm_xcomposer2.py&status=1#L254)

### video_cogvlm2
- NUM_FRAMES: é»˜è®¤ä¸º24ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/THUDM/CogVLM2/blob/main/video_demo/inference.py#L22)

### phi3_vision
- NUM_CROPS: é»˜è®¤ä¸º4ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/LLM-Research/Phi-3.5-vision-instruct)

### llama3_1_omni
- N_MELS: é»˜è®¤ä¸º128ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/ictnlp/LLaMA-Omni/blob/544d0ff3de8817fdcbc5192941a11cf4a72cbf2b/omni_speech/infer/infer.py#L57)

### video_llava
- NUM_FRAMES: é»˜è®¤ä¸º16


## å…¶ä»–ç¯å¢ƒå˜é‡
- CUDA_VISIBLE_DEVICES: æ§åˆ¶ä½¿ç”¨å“ªäº›GPUå¡ã€‚é»˜è®¤ä½¿ç”¨æ‰€æœ‰å¡
- ASCEND_RT_VISIBLE_DEVICES: æ§åˆ¶ä½¿ç”¨å“ªäº›NPUå¡ï¼ˆASCENDå¡ç”Ÿæ•ˆï¼‰ã€‚é»˜è®¤ä½¿ç”¨æ‰€æœ‰å¡
- MODELSCOPE_CACHE: æ§åˆ¶ç¼“å­˜è·¯å¾„ã€‚
- NPROC_PER_NODE: torchrunä¸­`--nproc_per_node`çš„å‚æ•°é€ä¼ ã€‚é»˜è®¤ä¸º1ã€‚è‹¥è®¾ç½®äº†`NPROC_PER_NODE`æˆ–è€…`NNODES`ç¯å¢ƒå˜é‡ï¼Œåˆ™ä½¿ç”¨torchrunå¯åŠ¨è®­ç»ƒæˆ–æ¨ç†
- MASTER_PORT: torchrunä¸­`--master_port`çš„å‚æ•°é€ä¼ ã€‚é»˜è®¤ä¸º29500
- MASTER_ADDR: torchrunä¸­`--master_addr`çš„å‚æ•°é€ä¼ 
- NNODES: torchrunä¸­`--nnodes`çš„å‚æ•°é€ä¼ 
- NODE_RANK: torchrunä¸­`--node_rank`çš„å‚æ•°é€ä¼ 
