# å‘½ä»¤è¡Œå‚æ•°

å‘½ä»¤è¡Œå‚æ•°çš„ä»‹ç»ä¼šåˆ†ä¸ºåŸºæœ¬å‚æ•°ï¼ŒåŸå­å‚æ•°ã€é›†æˆå‚æ•°å’Œç‰¹å®šæ¨¡å‹å‚æ•°ã€‚å‘½ä»¤è¡Œæœ€ç»ˆä½¿ç”¨çš„å‚æ•°åˆ—è¡¨ä¸ºé›†æˆå‚æ•°ã€‚é›†æˆå‚æ•°ç»§æ‰¿è‡ªåŸºæœ¬å‚æ•°å’Œä¸€äº›åŸå­å‚æ•°ã€‚ç‰¹å®šæ¨¡å‹å‚æ•°æ˜¯é’ˆå¯¹äºå…·ä½“æ¨¡å‹çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡`--model_kwargs'`æˆ–è€…ç¯å¢ƒå˜é‡è¿›è¡Œè®¾ç½®ã€‚

## åŸºæœ¬å‚æ•°

- ğŸ”¥tuner_backend: å¯é€‰ä¸º'peft', 'unsloth', é»˜è®¤ä¸º'peft'
- ğŸ”¥train_type: é»˜è®¤ä¸º'lora'. å¯é€‰ä¸º: 'lora', 'full', 'longlora', 'adalora', 'llamapro', 'adapter', 'vera', 'boft', 'fourierft', 'reft'
- ğŸ”¥adapters: ç”¨äºæŒ‡å®šadapterçš„id/pathçš„listï¼Œé»˜è®¤ä¸º`[]`.
- seed: é»˜è®¤ä¸º42
- model_kwargs: ç‰¹å®šæ¨¡å‹å¯ä¼ å…¥çš„é¢å¤–å‚æ•°. è¯¥å‚æ•°åˆ—è¡¨ä¼šåœ¨è®­ç»ƒæ¨ç†æ—¶æ‰“å°æ—¥å¿—è¿›è¡Œæç¤ºï¼Œä¾‹å¦‚`--model_kwargs '{"fps_max_frames": 12}'`
- load_args: å½“æŒ‡å®š`--resume_from_checkpoint`, `--model`, `--adapters`ä¼šè¯»å–ä¿å­˜æ–‡ä»¶ä¸­çš„`args.json`ï¼Œå°†é»˜è®¤ä¸ºNoneçš„`åŸºæœ¬å‚æ•°`ï¼ˆé™¤å»æ•°æ®å‚æ•°å’Œç”Ÿæˆå‚æ•°ï¼‰è¿›è¡Œèµ‹å€¼ï¼ˆå¯é€šè¿‡æ‰‹åŠ¨ä¼ å…¥è¿›è¡Œè¦†ç›–ï¼‰ã€‚é»˜è®¤ä¸ºTrue
- load_data_args: å¦‚æœå°†è¯¥å‚æ•°è®¾ç½®ä¸ºTrue, åˆ™ä¼šé¢å¤–è¯»å–æ•°æ®å‚æ•°. é»˜è®¤ä¸ºFalse
- use_hf: é»˜è®¤ä¸ºFalse. æ§åˆ¶æ¨¡å‹ä¸‹è½½ã€æ•°æ®é›†ä¸‹è½½ã€æ¨¡å‹pushçš„hub
- hub_token: hub token. modelscopeçš„hub tokenå¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/my/myaccesstoken)
- custom_register_path: è‡ªå®šä¹‰æ¨¡å‹ã€å¯¹è¯æ¨¡æ¿å’Œæ•°æ®é›†æ³¨å†Œçš„`.py`æ–‡ä»¶è·¯å¾„

### æ¨¡å‹å‚æ•°
- ğŸ”¥model: æ¨¡å‹idæˆ–æ¨¡å‹æœ¬åœ°è·¯å¾„ã€‚å¦‚æœæ˜¯è‡ªå®šä¹‰æ¨¡å‹è¯·é…åˆ`model_type`å’Œ`template`ä½¿ç”¨ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ[è‡ªå®šä¹‰æ¨¡å‹](../Customization/è‡ªå®šä¹‰æ¨¡å‹.md)
- model_type: æ¨¡å‹ç±»å‹ã€‚ç›¸åŒçš„æ¨¡å‹æ¶æ„ã€templateã€æ¨¡å‹åŠ è½½è¿‡ç¨‹è¢«å®šä¹‰ä¸ºä¸€ä¸ªmodel_type
- model_revision: æ¨¡å‹ç‰ˆæœ¬
- task_type: é»˜è®¤ä¸º'causal_lm'. å¯é€‰ä¸º'causal_lm', 'seq_cls'. seq_clsçš„ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/train/seq_cls).
- ğŸ”¥torch_dtype: æ¨¡å‹æƒé‡çš„æ•°æ®ç±»å‹ï¼Œæ”¯æŒ`float16`,`bfloat16`,`float32`ï¼Œé»˜è®¤ä»configæ–‡ä»¶ä¸­è¯»å–
- attn_impl: attentionç±»å‹ï¼Œå¯é€‰é¡¹ä¸º`flash_attn`, `sdpa`, `eager`ï¼Œé»˜è®¤ä½¿ç”¨sdpaã€‚æ³¨æ„ï¼šè¿™ä¸‰ç§å®ç°å¹¶ä¸ä¸€å®šæ”¯æŒï¼Œè¿™å–å†³äºå¯¹åº”æ¨¡å‹çš„æ”¯æŒæƒ…å†µã€‚
- num_labels: åˆ†ç±»æ¨¡å‹éœ€è¦æŒ‡å®šã€‚ä»£è¡¨æ ‡ç­¾æ•°é‡ï¼Œé»˜è®¤ä¸ºNone
- rope_scaling: ropeç±»å‹ï¼Œæ”¯æŒ`linear`å’Œ`dynamic`ï¼Œè¯·é…åˆ`max_length`å…±åŒä½¿ç”¨
- device_map: æ¨¡å‹ä½¿ç”¨çš„device_mapé…ç½®ï¼Œä¾‹å¦‚ï¼š'auto'ã€'cpu'ã€jsonå­—ç¬¦ä¸²ã€jsonæ–‡ä»¶è·¯å¾„
- local_repo_path: éƒ¨åˆ†æ¨¡å‹åœ¨åŠ è½½æ—¶ä¾èµ–äºgithub repo. ä¸ºäº†é¿å…`git clone`æ—¶é‡åˆ°ç½‘ç»œé—®é¢˜, å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°repo. è¯¥å‚æ•°éœ€è¦ä¼ å…¥æœ¬åœ°repoçš„è·¯å¾„, é»˜è®¤ä¸º`None`

### æ•°æ®å‚æ•°
- ğŸ”¥dataset: æ•°æ®é›†idæˆ–è·¯å¾„ã€‚ä¼ å…¥æ ¼å¼ä¸ºï¼š`æ•°æ®é›†id or æ•°æ®é›†è·¯å¾„:å­æ•°æ®é›†#å–æ ·æ•°é‡`ï¼Œå…¶ä¸­å­æ•°æ®é›†å’Œå–æ ·æ•°æ®å¯é€‰ã€‚ç©ºæ ¼åˆ†å‰²ä¼ é€’å¤šä¸ªæ•°æ®é›†ã€‚æœ¬åœ°æ•°æ®é›†æ”¯æŒjsonlã€csvã€jsonã€æ–‡ä»¶å¤¹ç­‰ã€‚è‡ªå®šä¹‰æ•°æ®é›†å¯ä»¥å‚è€ƒ[è‡ªå®šä¹‰æ•°æ®é›†](../Customization/è‡ªå®šä¹‰æ•°æ®é›†.md)
- ğŸ”¥val_dataset: éªŒè¯é›†idæˆ–è·¯å¾„
- ğŸ”¥split_dataset_ratio: ä¸æŒ‡å®šval_datasetæ—¶å¦‚ä½•æ‹†åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œé»˜è®¤ä¸º0.01
- data_seed: æ•°æ®é›†éšæœºç§å­ï¼Œé»˜è®¤ä¸º42
- ğŸ”¥dataset_num_proc: æ•°æ®é›†é¢„å¤„ç†çš„è¿›ç¨‹æ•°ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥streaming: æµå¼è¯»å–å¹¶å¤„ç†æ•°æ®é›†ï¼Œé»˜è®¤False
- enable_cache: æ•°æ®é›†é¢„å¤„ç†ä½¿ç”¨cacheï¼Œé»˜è®¤False
  - æ³¨æ„: å¦‚æœæ”¹ä¸ºTrueï¼Œåœ¨æ•°æ®é›†æœ‰æ›´æ”¹æ—¶å¯èƒ½æ— æ³•ç”Ÿæ•ˆï¼Œå¦‚æœä¿®æ”¹æœ¬å‚æ•°å‘ç°è®­ç»ƒä¸æ­£å¸¸è¯·è€ƒè™‘è®¾ç½®ä¸ºFalse
- download_mode: æ•°æ®é›†ä¸‹è½½æ¨¡å¼ï¼ŒåŒ…å«`reuse_dataset_if_exists`å’Œ`force_redownload`ï¼Œé»˜è®¤ä¸ºreuse_dataset_if_exists
- strict: å¦‚æœä¸ºTrueï¼Œåˆ™æ•°æ®é›†åªè¦æŸè¡Œæœ‰é—®é¢˜ç›´æ¥æŠ›é”™ï¼Œå¦åˆ™ä¼šä¸¢å¼ƒå‡ºé”™è¡Œã€‚é»˜è®¤False
- ğŸ”¥model_name: ä»…ç”¨äºè‡ªæˆ‘è®¤çŸ¥ä»»åŠ¡ï¼Œä¼ å…¥æ¨¡å‹ä¸­æ–‡åå’Œè‹±æ–‡åï¼Œä»¥ç©ºæ ¼åˆ†éš”
- ğŸ”¥model_author: ä»…ç”¨äºè‡ªæˆ‘è®¤çŸ¥ä»»åŠ¡ï¼Œä¼ å…¥æ¨¡å‹ä½œè€…çš„ä¸­æ–‡åå’Œè‹±æ–‡åï¼Œä»¥ç©ºæ ¼åˆ†éš”
- custom_dataset_info: è‡ªå®šä¹‰ç®€å•æ•°æ®é›†æ³¨å†Œï¼Œå‚è€ƒ[è‡ªå®šä¹‰æ•°æ®é›†](../Customization/è‡ªå®šä¹‰æ•°æ®é›†.md)

### æ¨¡æ¿å‚æ•°
- ğŸ”¥template: å¯¹è¯æ¨¡æ¿ç±»å‹ï¼Œé»˜è®¤ä½¿ç”¨modelå¯¹åº”çš„templateç±»å‹ã€‚`swift pt`ä¼šå°†å¯¹è¯æ¨¡ç‰ˆè½¬ä¸ºç”Ÿæˆæ¨¡æ¿ä½¿ç”¨
- ğŸ”¥system: è‡ªå®šä¹‰systemå­—æ®µï¼Œé»˜è®¤ä¸ºNoneï¼Œä½¿ç”¨templateçš„é»˜è®¤system
- ğŸ”¥max_length: å•æ ·æœ¬çš„tokensæœ€å¤§é•¿åº¦ã€‚é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸ºæ¨¡å‹æ”¯æŒçš„tokensæœ€å¤§é•¿åº¦(max_model_len)
- truncation_strategy: å¦‚æœè¶…é•¿å¦‚ä½•å¤„ç†ï¼Œæ”¯æŒ`delete`, `left`å’Œ`right`ï¼Œä»£è¡¨åˆ é™¤ã€å·¦ä¾§è£å‰ªå’Œå³ä¾§è£å‰ªï¼Œé»˜è®¤ä¸º'delete'
- ğŸ”¥max_pixels: å¤šæ¨¡æ€æ¨¡å‹å›¾ç‰‡å‰å¤„ç†çš„æœ€å¤§åƒç´ æ•°ï¼ˆH\*Wï¼‰ï¼Œé»˜è®¤ä¸ç¼©æ”¾ã€‚
- tools_prompt: æ™ºèƒ½ä½“è®­ç»ƒæ—¶çš„å·¥å…·åˆ—è¡¨è½¬ä¸ºsystemçš„æ ¼å¼ï¼Œè¯·å‚è€ƒ[æ™ºèƒ½ä½“è®­ç»ƒ](./æ™ºèƒ½ä½“çš„æ”¯æŒ.md)ï¼Œé»˜è®¤ä¸º'react_en'
- padding_side: å½“è®­ç»ƒ`batch_size>=2`æ—¶çš„padding_sideï¼Œå¯é€‰å€¼ä¸º'left', 'right'ï¼Œé»˜è®¤ä¸º'right'ã€‚ï¼ˆ`generate`çš„batch_size>=2æ—¶ï¼Œåªè¿›è¡Œå·¦paddingï¼‰
- loss_scale: å¦‚ä½•é’ˆå¯¹è®­ç»ƒæ·»åŠ tokençš„lossæƒé‡ã€‚é»˜è®¤ä¸º`'default'`ï¼Œä»£è¡¨æ‰€æœ‰responseï¼ˆå«historyï¼‰ä»¥1è®¡ç®—äº¤å‰ç†µæŸå¤±ã€‚å¯é€‰å€¼ä¸º'default', 'last_round', 'all', ä»¥åŠagentéœ€è¦çš„loss_scale: 'react', 'agentflan', 'alpha_umi', 'qwen'ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹[æ’ä»¶åŒ–](../Customization/æ’ä»¶åŒ–.md)å’Œ[æ™ºèƒ½ä½“è®­ç»ƒ](./æ™ºèƒ½ä½“çš„æ”¯æŒ.md)
- sequence_parallel_size: åºåˆ—å¹¶è¡Œæ•°é‡ã€‚å‚è€ƒ[example](https://github.com/modelscope/ms-swift/tree/main/examples/train/sequence_parallel/train.sh)
- use_chat_template: ä½¿ç”¨chatæ¨¡æ¿æˆ–generationæ¨¡æ¿ï¼Œé»˜è®¤ä¸º`True`ã€‚`swift pt`ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºgenerationæ¨¡æ¿
- template_backend: ä½¿ç”¨swiftæˆ–jinjaè¿›è¡Œæ¨ç†ã€‚å¦‚æœä½¿ç”¨jinjaï¼Œåˆ™ä½¿ç”¨transformersçš„`apply_chat_template`ã€‚é»˜è®¤ä¸ºswift

### ç”Ÿæˆå‚æ•°
å‚è€ƒ[generation_config](https://huggingface.co/docs/transformers/main_classes/text_generation#transformers.GenerationConfig)æ–‡æ¡£

- ğŸ”¥max_new_tokens: æ¨ç†æ”¯æŒçš„æœ€å¤§æ–°tokenæ•°é‡ï¼Œé»˜è®¤ä¸ºNoneï¼Œæ— é™åˆ¶
- temperature: æ¸©åº¦å‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.json
  - æ³¨æ„ï¼šdo_sampleå‚æ•°åœ¨æœ¬ç‰ˆæœ¬ä¸­ç§»é™¤äº†ï¼Œè¯·å°†temperatureé…ç½®ä¸º0æ¥è¾¾åˆ°ç›¸åŒæ•ˆæœ
- top_k: top_kå‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.json
- top_p: top_på‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.json
- repetition_penalty: é‡å¤æƒ©ç½šé¡¹ï¼Œé»˜è®¤ä¸ºNoneï¼Œè¯»å–generation_config.json
- num_beams: beam searchçš„å¹¶è¡Œä¿ç•™æ•°é‡ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥stream: æµå¼è¾“å‡ºï¼Œé»˜è®¤ä¸º`False`
- stop_words: é¢å¤–çš„åœæ­¢è¯ï¼Œé»˜è®¤ä¸º`[]`
- logprobs: æ˜¯å¦è¾“å‡ºlogprobsï¼Œé»˜è®¤ä¸ºFalse

### é‡åŒ–å‚æ•°
ä»¥ä¸‹ä¸ºæ‹‰èµ·æ¨¡å‹æ—¶é‡åŒ–çš„å‚æ•°ï¼Œå…·ä½“å«ä¹‰å¯ä»¥æŸ¥çœ‹[é‡åŒ–](https://huggingface.co/docs/transformers/main/en/main_classes/quantization)æ–‡æ¡£ã€‚è¿™é‡Œä¸åŒ…å«`swift export`ä¸­æ¶‰åŠçš„`gptq`ã€`awq`é‡åŒ–å‚æ•°

- ğŸ”¥quant_method: åŠ è½½æ¨¡å‹æ—¶é‡‡ç”¨çš„é‡åŒ–æ–¹æ³•ï¼Œå¯é€‰é¡¹ä¸º`bnb`, `hqq`, `eetq`
- ğŸ”¥quant_bits: é‡åŒ–bitsæ•°ï¼Œé»˜è®¤ä¸ºNone
- hqq_axis: hqqé‡åŒ–axisï¼Œé»˜è®¤ä¸ºNone
- bnb_4bit_compute_dtype: bnbé‡åŒ–è®¡ç®—ç±»å‹ï¼Œå¯é€‰ä¸º`float16`ã€`bfloat16`ã€`float32`ï¼Œé»˜è®¤è®¾ç½®ä¸º`torch_dtype`
- bnb_4bit_quant_type: bnbé‡åŒ–ç±»å‹ï¼Œæ”¯æŒ`fp4`å’Œ`nf4`ï¼Œé»˜è®¤ä¸º`nf4`
- bnb_4bit_use_double_quant: æ˜¯å¦ä½¿ç”¨åŒé‡é‡åŒ–ï¼Œé»˜è®¤ä¸º`True`
- bnb_4bit_quant_storage: bnbé‡åŒ–å­˜å‚¨ç±»å‹ï¼Œé»˜è®¤ä¸ºNone


## åŸå­å‚æ•°

### Seq2SeqTrainerå‚æ•°

è¯¥å‚æ•°åˆ—è¡¨ç»§æ‰¿è‡ªtransformers `Seq2SeqTrainingArguments`ï¼Œms-swiftå¯¹å…¶é»˜è®¤å€¼è¿›è¡Œäº†è¦†ç›–ã€‚æœªåˆ—å‡ºçš„è¯·å‚è€ƒ[HFå®˜æ–¹æ–‡æ¡£](https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.Seq2SeqTrainingArguments)

- ğŸ”¥output_dir: é»˜è®¤ä¸º`output/<model_name>`
- ğŸ”¥gradient_checkpointing: æ˜¯å¦ä½¿ç”¨gradient_checkpointingï¼Œé»˜è®¤ä¸ºTrue
- ğŸ”¥deepspeed: é»˜è®¤ä¸ºNone. å¯ä»¥è®¾ç½®ä¸º'zero0', 'zero1', 'zero2', 'zero3', 'zero2_offload', 'zero3_offload'æ¥ä½¿ç”¨ms-swiftå†…ç½®çš„deepspeedé…ç½®æ–‡ä»¶
- ğŸ”¥per_device_train_batch_size: é»˜è®¤å€¼1
- ğŸ”¥per_device_eval_batch_size: é»˜è®¤å€¼1
- weight_decay: weightè¡°å‡ç³»æ•°ï¼Œé»˜è®¤å€¼0.1
- ğŸ”¥learning_rate: å­¦ä¹ ç‡ï¼Œå…¨å‚æ•°é»˜è®¤ä¸º1e-5ï¼Œtunerä¸º1e-4
- lr_scheduler_type: lr_schedulerç±»å‹ï¼Œé»˜è®¤ä¸ºcosine
- lr_scheduler_kwargs: lr_schedulerå…¶ä»–å‚æ•°
- ğŸ”¥gradient_checkpointing_kwargs: ä¼ å…¥`torch.utils.checkpoint`ä¸­çš„å‚æ•°. ä¾‹å¦‚è®¾ç½®ä¸º`--gradient_checkpointing_kwargs '{"use_reentrant": false}'`
- report_to: é»˜è®¤å€¼ä¸º`tensorboard`ã€‚ä½ ä¹Ÿå¯ä»¥æŒ‡å®š`--report_to tensorboard wandb`, `--report_to all`
- remove_unused_columns: é»˜è®¤å€¼False
- logging_first_step: æ˜¯å¦è®°å½•ç¬¬ä¸€ä¸ªstepçš„æ‰“å°ï¼Œé»˜è®¤å€¼True
- logging_steps: æ—¥å¿—æ‰“å°é—´éš”ï¼Œé»˜è®¤å€¼5
- metric_for_best_model: é»˜è®¤ä¸ºNone. å³å½“`predict_with_generate`è®¾ç½®ä¸ºFalse, åˆ™ä¸º'loss', å¦åˆ™è®¾ç½®ä¸º'rouge-l'
- greater_is_better: é»˜è®¤ä¸ºNone. å³å½“`metric_for_best_model`å«'loss'æ—¶, è®¾ç½®ä¸ºFalse, å¦åˆ™è®¾ç½®ä¸ºTrue.


å…¶ä»–é‡è¦å‚æ•°ï¼š
- ğŸ”¥num_train_epochs: è®­ç»ƒçš„epochæ•°ï¼Œé»˜è®¤ä¸º3
- ğŸ”¥gradient_accumulation_steps: æ¢¯åº¦ç´¯åŠ ï¼Œé»˜è®¤ä¸º1
- ğŸ”¥save_strategy: ä¿å­˜æ¨¡å‹çš„ç­–ç•¥, å¯é€‰ä¸º'no', 'steps', 'epoch', é»˜è®¤ä¸º'steps'
- ğŸ”¥save_steps: é»˜è®¤ä¸º500
- ğŸ”¥eval_strategy: é»˜è®¤ä¸ºNone, è¯„ä¼°ç­–ç•¥, è·Ÿéš`save_strategy`çš„ç­–ç•¥
- ğŸ”¥eval_steps: é»˜è®¤ä¸ºNone, å¦‚æœå­˜åœ¨è¯„ä¼°æ•°æ®é›†, åˆ™è·Ÿéš`save_steps`çš„ç­–ç•¥
- ğŸ”¥save_total_limit: é»˜è®¤ä¸ºNone, ä¿å­˜æ‰€æœ‰çš„checkpoint
- max_steps: é»˜è®¤ä¸º-1ï¼Œæœ€å¤§è®­ç»ƒçš„stepsæ•°ï¼Œåœ¨æ•°æ®é›†ä¸ºæµå¼æ—¶éœ€è¦è®¾ç½®
- ğŸ”¥warmup_ratio: é»˜è®¤ä¸º0.
- save_on_each_node: é»˜è®¤ä¸ºFalse. åœ¨å¤šæœºè®­ç»ƒæ—¶éœ€è¦è¢«è€ƒè™‘
- save_only_model: é»˜è®¤ä¸ºFalse. æ˜¯å¦åªä¿å­˜æ¨¡å‹æƒé‡
- ğŸ”¥resume_from_checkpoint: æ–­ç‚¹ç»­è®­å‚æ•°, é»˜è®¤ä¸ºNone
- ğŸ”¥ddp_backend: é»˜è®¤ä¸ºNoneï¼Œå¯é€‰ä¸º"nccl", "gloo", "mpi", "ccl", "hccl", "cncl", "mccl"
- ğŸ”¥ddp_find_unused_parameters: é»˜è®¤ä¸ºNone
- ğŸ”¥dataloader_num_workers: é»˜è®¤ä¸º0
- ğŸ”¥neftune_noise_alpha: neftuneæ·»åŠ çš„å™ªå£°ç³»æ•°, é»˜è®¤ä¸º0ï¼Œé€šå¸¸å¯ä»¥è®¾ç½®ä¸º5, 10, 15
- average_tokens_across_devices: æ˜¯å¦åœ¨è®¾å¤‡ä¹‹é—´çš„tokenæ•°è¿›è¡Œå¹³å‡ã€‚å¦‚æœè®¾ç½®ä¸ºTrueï¼Œå°†ä½¿ç”¨all_reduceåŒæ­¥`num_tokens_in_batch`ä»¥è¿›è¡Œç²¾ç¡®çš„æŸå¤±è®¡ç®—ã€‚é»˜è®¤ä¸ºFalse
- max_grad_norm: æ¢¯åº¦è£å‰ª. é»˜è®¤ä¸º1.
- push_to_hub: æ¨é€è®­ç»ƒæƒé‡åˆ°hub. é»˜è®¤ä¸ºFalse
- hub_model_id: é»˜è®¤ä¸ºNone
- hub_private_repo: é»˜è®¤ä¸ºFalse

### Tunerå‚æ•°
- ğŸ”¥freeze_llm: å†»ç»“LLM. é»˜è®¤ä¸ºFalse. å¯ç”¨äºå…¨å‚å’ŒLoRA
- ğŸ”¥freeze_vit: å†»ç»“ViT. é»˜è®¤ä¸ºTrue. å¯ç”¨äºå…¨å‚å’ŒLoRA
- ğŸ”¥freeze_aligner: å†»ç»“aligner. é»˜è®¤ä¸ºTrue, å¯ç”¨äºå…¨å‚å’ŒLoRA
- ğŸ”¥target_modules: æŒ‡å®šloraæ¨¡å—, é»˜è®¤ä¸º`all-linear`. åœ¨LLMå’Œå¤šæ¨¡æ€LLMä¸­ï¼Œå…¶è¡Œä¸ºæœ‰æ‰€ä¸åŒ. è‹¥æ˜¯LLMåˆ™è‡ªåŠ¨å¯»æ‰¾é™¤lm_headå¤–çš„linearå¹¶é™„åŠ tunerï¼Œè‹¥æ˜¯å¤šæ¨¡æ€LLMï¼Œåˆ™é»˜è®¤åªåœ¨LLMä¸Šé™„åŠ tunerï¼Œè¯¥è¡Œä¸ºå¯ä»¥è¢«`freeze_llm`, `freeze_vit`, `freeze_aligner`æ§åˆ¶. è¯¥å‚æ•°ä¸é™äºLoRA
- ğŸ”¥target_regex: æŒ‡å®šloraæ¨¡å—çš„regexè¡¨è¾¾å¼. é»˜è®¤ä¸º`None`, å¦‚æœè¯¥å€¼ä¼ å…¥, åˆ™target_modulesä¸ç”Ÿæ•ˆ. è¯¥å‚æ•°ä¸é™äºLoRA
- ğŸ”¥init_weights: åˆå§‹åŒ–weightsçš„æ–¹æ³•, LoRAå¯ä»¥æŒ‡å®šä¸º`true`, `false`, `guassian`, `pissa`, `pissa_niter_[number of iters]`, Boneå¯ä»¥æŒ‡å®šä¸º`true`, `false`, `bat`, é»˜è®¤å€¼`true`
- modules_to_save: åœ¨å·²é™„åŠ tuneråï¼ŒåŸæ¨¡å‹å‚ä¸è®­ç»ƒå’Œå­˜å‚¨çš„æ¨¡å—ï¼Œé»˜è®¤ä¸º`[]`. è¯¥å‚æ•°ä¸é™äºLoRA

#### å…¨å‚
- freeze_parameters: è¢«å†»ç»“å‚æ•°çš„å‰ç¼€, é»˜è®¤ä¸º`[]`
- freeze_parameters_ratio: ä»ä¸‹å¾€ä¸Šå†»ç»“çš„å‚æ•°æ¯”ä¾‹, é»˜è®¤ä¸º0. å¯è®¾ç½®ä¸º1å°†æ‰€æœ‰å‚æ•°å†»ç»“, ç»“åˆ`trainable_parameters`è®¾ç½®å¯è®­ç»ƒå‚æ•°.
- trainable_parameters: å¯è®­ç»ƒå‚æ•°çš„å‰ç¼€, é»˜è®¤ä¸º`[]`. `trainable_parameters`çš„ä¼˜å…ˆçº§é«˜äº`freeze_parameters`å’Œ`freeze_parameters_ratio`

#### LoRA
- ğŸ”¥lora_rank: é»˜è®¤ä¸º`8`
- ğŸ”¥lora_alpha: é»˜è®¤ä¸º`32`
- lora_dropout: é»˜è®¤ä¸º`0.05`
- lora_bias: é»˜è®¤ä¸º`'none'`, å¯ä»¥é€‰æ‹©çš„å€¼: 'none', 'all'. å¦‚æœä½ è¦å°†biaså…¨éƒ½è®¾ç½®ä¸ºå¯è®­ç»ƒ, ä½ å¯ä»¥è®¾ç½®ä¸º`'all'`
- lora_dtype: æŒ‡å®šloraæ¨¡å—çš„dtypeç±»å‹. æ”¯æŒ'float16', 'bfloat16', 'float32'ï¼Œä¸è®¾ç½®é»˜è®¤è·ŸéšåŸæ¨¡å‹ç±»å‹
- ğŸ”¥use_dora: é»˜è®¤ä¸º`False`, æ˜¯å¦ä½¿ç”¨`DoRA`
- use_rslora: é»˜è®¤ä¸º`False`, æ˜¯å¦ä½¿ç”¨`RS-LoRA`
- ğŸ”¥lorap_lr_ratio: LoRA+å‚æ•°, é»˜è®¤å€¼`None`, å»ºè®®å€¼`10~16`, ä½¿ç”¨loraæ—¶æŒ‡å®šè¯¥å‚æ•°å³å¯ä½¿ç”¨lora+.
- init_weights: æƒé‡åˆå§‹åŒ–æ–¹æ³•ï¼Œé€‚ç”¨äºæ”¯æŒçš„ Tunerã€‚é»˜è®¤å€¼ä¸º `true`ã€‚

##### LoRA-GA
- lora_ga_batch_size: é»˜è®¤å€¼ä¸º `2`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶ä½¿ç”¨çš„æ‰¹å¤„ç†å¤§å°ã€‚
- lora_ga_iters: é»˜è®¤å€¼ä¸º `2`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶çš„è¿­ä»£æ¬¡æ•°ã€‚
- lora_ga_max_length: é»˜è®¤å€¼ä¸º `1024`ã€‚åœ¨ LoRA-GA ä¸­ä¼°è®¡æ¢¯åº¦ä»¥è¿›è¡Œåˆå§‹åŒ–æ—¶çš„æœ€å¤§è¾“å…¥é•¿åº¦ã€‚
- lora_ga_direction: é»˜è®¤å€¼ä¸º `ArB2r`ã€‚åœ¨ LoRA-GA ä¸­ä½¿ç”¨ä¼°è®¡æ¢¯åº¦è¿›è¡Œåˆå§‹åŒ–æ—¶çš„åˆå§‹æ–¹å‘ã€‚å…è®¸çš„å€¼æœ‰ï¼š`ArBr`ã€`A2rBr`ã€`ArB2r` å’Œ `random`ã€‚
- lora_ga_scale: é»˜è®¤å€¼ä¸º `stable`ã€‚LoRA-GA çš„åˆå§‹åŒ–ç¼©æ”¾æ–¹å¼ã€‚å…è®¸çš„å€¼æœ‰ï¼š`gd`ã€`unit`ã€`stable` å’Œ `weightS`ã€‚
- lora_ga_stable_gamma: é»˜è®¤å€¼ä¸º `16`ã€‚å½“åˆå§‹åŒ–æ—¶é€‰æ‹© `stable` ç¼©æ”¾æ—¶çš„ gamma å€¼ã€‚

#### FourierFt

FourierFtä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- fourier_n_frequency: å‚…é‡Œå¶å˜æ¢çš„é¢‘ç‡æ•°é‡, `int`ç±»å‹, ç±»ä¼¼äºLoRAä¸­çš„`r`. é»˜è®¤å€¼`2000`.
- fourier_scaling: WçŸ©é˜µçš„ç¼©æ”¾å€¼, `float`ç±»å‹, ç±»ä¼¼LoRAä¸­çš„`lora_alpha`. é»˜è®¤å€¼`300.0`.

#### BOFT

BOFTä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- boft_block_size: BOFTå—å°ºå¯¸, é»˜è®¤å€¼4.
- boft_block_num: BOFTå—æ•°é‡, ä¸èƒ½å’Œ`boft_block_size`åŒæ—¶ä½¿ç”¨.
- boft_dropout: boftçš„dropoutå€¼, é»˜è®¤0.0.

#### Vera

Veraä½¿ç”¨`target_modules`, `target_regex`, `modules_to_save`ä¸‰ä¸ªå‚æ•°.

- vera_rank: Vera Attentionçš„å°ºå¯¸, é»˜è®¤å€¼256.
- vera_projection_prng_key: æ˜¯å¦å­˜å‚¨Veraæ˜ å°„çŸ©é˜µ, é»˜è®¤ä¸ºTrue.
- vera_dropout: Veraçš„dropoutå€¼, é»˜è®¤`0.0`.
- vera_d_initial: Veraçš„dçŸ©é˜µçš„åˆå§‹å€¼, é»˜è®¤`0.1`.

#### GaLore

- ğŸ”¥use_galore: é»˜è®¤å€¼False, æ˜¯å¦ä½¿ç”¨GaLore.
- galore_target_modules: é»˜è®¤å€¼None, ä¸ä¼ çš„æƒ…å†µä¸‹å¯¹attentionå’Œmlpåº”ç”¨GaLore.
- galore_rank: é»˜è®¤å€¼128, GaLoreçš„rankå€¼.
- galore_update_proj_gap: é»˜è®¤å€¼50, åˆ†è§£çŸ©é˜µçš„æ›´æ–°é—´éš”.
- galore_scale: é»˜è®¤å€¼1.0, çŸ©é˜µæƒé‡ç³»æ•°.
- galore_proj_type: é»˜è®¤å€¼`std`, GaLoreçŸ©é˜µåˆ†è§£ç±»å‹.
- galore_optim_per_parameter: é»˜è®¤å€¼False, æ˜¯å¦ç»™æ¯ä¸ªGaloreç›®æ ‡Parameterè®¾å®šä¸€ä¸ªå•ç‹¬çš„optimizer.
- galore_with_embedding: é»˜è®¤å€¼False, æ˜¯å¦å¯¹embeddingåº”ç”¨GaLore.
- galore_quantization: æ˜¯å¦ä½¿ç”¨q-galore. é»˜è®¤å€¼`False`.
- galore_proj_quant: æ˜¯å¦å¯¹SVDåˆ†è§£çŸ©é˜µåšé‡åŒ–, é»˜è®¤`False`.
- galore_proj_bits: SVDé‡åŒ–bitæ•°.
- galore_proj_group_size: SVDé‡åŒ–åˆ†ç»„æ•°.
- galore_cos_threshold: æŠ•å½±çŸ©é˜µæ›´æ–°çš„cosç›¸ä¼¼åº¦é˜ˆå€¼. é»˜è®¤å€¼0.4.
- galore_gamma_proj: åœ¨æŠ•å½±çŸ©é˜µé€æ¸ç›¸ä¼¼åä¼šæ‹‰é•¿æ›´æ–°é—´éš”, æœ¬å‚æ•°ä¸ºæ¯æ¬¡æ‹‰é•¿é—´éš”çš„ç³»æ•°, é»˜è®¤å€¼2.
- galore_queue_size: è®¡ç®—æŠ•å½±çŸ©é˜µç›¸ä¼¼åº¦çš„é˜Ÿåˆ—é•¿åº¦, é»˜è®¤å€¼5.

#### LISA

æ³¨æ„:LISAä»…æ”¯æŒå…¨å‚æ•°ï¼Œå³train_type full`.

- ğŸ”¥lisa_activated_layers: é»˜è®¤å€¼`0`, ä»£è¡¨ä¸ä½¿ç”¨LISAï¼Œæ”¹ä¸ºé0ä»£è¡¨éœ€è¦æ¿€æ´»çš„layersä¸ªæ•°ï¼Œå»ºè®®è®¾ç½®ä¸º2æˆ–8.
- lisa_step_interval: é»˜è®¤å€¼`20`, å¤šå°‘iteråˆ‡æ¢å¯åå‘ä¼ æ’­çš„layers.

#### UNSLOTH

ğŸ”¥unslothæ— æ–°å¢å‚æ•°ï¼Œå¯¹å·²æœ‰å‚æ•°è¿›è¡Œè°ƒèŠ‚å³å¯æ”¯æŒ:

```
--tuner_backend unsloth
--train_type full/lora
--quant_bits 4
```

#### LLAMAPRO

- ğŸ”¥llamapro_num_new_blocks: é»˜è®¤å€¼`4`, æ’å…¥çš„æ–°layersæ€»æ•°.
- llamapro_num_groups: é»˜è®¤å€¼`None`, åˆ†ä¸ºå¤šå°‘ç»„æ’å…¥new_blocks, å¦‚æœä¸º`None`åˆ™ç­‰äº`llamapro_num_new_blocks`, å³æ¯ä¸ªæ–°çš„layerå•ç‹¬æ’å…¥åŸæ¨¡å‹.

#### AdaLoRA

ä»¥ä¸‹å‚æ•°`train_type`è®¾ç½®ä¸º`adalora`æ—¶ç”Ÿæ•ˆ. adaloraçš„`target_modules`ç­‰å‚æ•°ç»§æ‰¿äºloraçš„å¯¹åº”å‚æ•°, ä½†`lora_dtype`å‚æ•°ä¸ç”Ÿæ•ˆ.

- adalora_target_r: é»˜è®¤å€¼`8`, adaloraçš„å¹³å‡rank.
- adalora_init_r: é»˜è®¤å€¼`12`, adaloraçš„åˆå§‹rank.
- adalora_tinit: é»˜è®¤å€¼`0`, adaloraçš„åˆå§‹warmup.
- adalora_tfinal: é»˜è®¤å€¼`0`, adaloraçš„final warmup.
- adalora_deltaT: é»˜è®¤å€¼`1`, adaloraçš„stepé—´éš”.
- adalora_beta1: é»˜è®¤å€¼`0.85`, adaloraçš„EMAå‚æ•°.
- adalora_beta2: é»˜è®¤å€¼`0.85`, adaloraçš„EMAå‚æ•°.
- adalora_orth_reg_weight: é»˜è®¤å€¼`0.5`, adaloraçš„æ­£åˆ™åŒ–å‚æ•°.

#### ReFT

ä»¥ä¸‹å‚æ•°`train_type`è®¾ç½®ä¸º`reft`æ—¶ç”Ÿæ•ˆ.

> 1. ReFTæ— æ³•åˆå¹¶tuner
> 2. ReFTå’Œgradient_checkpointingä¸å…¼å®¹
> 3. å¦‚æœä½¿ç”¨DeepSpeedé‡åˆ°é—®é¢˜è¯·æš‚æ—¶å¸è½½DeepSpeed

- ğŸ”¥reft_layers: ReFTåº”ç”¨äºå“ªäº›å±‚ä¸Š, é»˜è®¤ä¸º`None`, ä»£è¡¨æ‰€æœ‰å±‚, å¯ä»¥è¾“å…¥å±‚å·çš„list, ä¾‹å¦‚reft_layers 1 2 3 4`
- ğŸ”¥reft_rank: ReFTçŸ©é˜µçš„rank, é»˜è®¤ä¸º`4`.
- reft_intervention_type: ReFTçš„ç±»å‹, æ”¯æŒ'NoreftIntervention', 'LoreftIntervention', 'ConsreftIntervention', 'LobireftIntervention', 'DireftIntervention', 'NodireftIntervention', é»˜è®¤ä¸º`LoreftIntervention`.
- reft_args: ReFT Interventionä¸­çš„å…¶ä»–æ”¯æŒå‚æ•°, ä»¥json-stringæ ¼å¼è¾“å…¥.

#### Liger

- use_liger: ä½¿ç”¨liger-kernelè¿›è¡Œè®­ç»ƒ.

### LMDeployå‚æ•°
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[lmdeployæ–‡æ¡£](https://lmdeploy.readthedocs.io/en/latest/api/pipeline.html#turbomindengineconfig)

- ğŸ”¥tp: tensorå¹¶è¡Œåº¦. é»˜è®¤å€¼`1`
- session_len: é»˜è®¤å€¼`None`
- cache_max_entry_count: é»˜è®¤å€¼`0.8`
- quant_policy: é»˜è®¤å€¼`0`
- vision_batch_size: é»˜è®¤å€¼`1`

### vLLMå‚æ•°
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[vllmæ–‡æ¡£](https://docs.vllm.ai/en/latest/models/engine_args.html)

- ğŸ”¥gpu_memory_utilization: é»˜è®¤å€¼`0.9`
- ğŸ”¥tensor_parallel_size: é»˜è®¤ä¸º`1`
- pipeline_parallel_size: é»˜è®¤ä¸º`1`
- max_num_seqs: é»˜è®¤ä¸º`256`
- ğŸ”¥max_model_len: é»˜è®¤ä¸º`None`
- disable_custom_all_reduce: é»˜è®¤ä¸º`False`
- enforce_eager: vllmä½¿ç”¨pytorch eageræ¨¡å¼è¿˜æ˜¯å»ºç«‹cuda graph. é»˜è®¤ä¸º`False`. è®¾ç½®ä¸ºTrueå¯ä»¥èŠ‚çº¦æ˜¾å­˜, ä½†ä¼šå½±å“æ•ˆç‡.
- ğŸ”¥limit_mm_per_prompt: æ§åˆ¶vllmä½¿ç”¨å¤šå›¾, é»˜è®¤ä¸º`None`. ä¾‹å¦‚ä¼ å…¥`--limit_mm_per_prompt '{"image": 10, "video": 5}'`
- vllm_max_lora_rank: é»˜è®¤ä¸º`16`. vllmå¯¹äºloraæ”¯æŒçš„å‚æ•°


### åˆå¹¶å‚æ•°

- ğŸ”¥merge_lora: æ˜¯å¦åˆå¹¶loraï¼Œæœ¬å‚æ•°æ”¯æŒloraã€llamaproã€longloraï¼Œé»˜è®¤ä¸ºFalse
- safe_serialization: æ˜¯å¦å­˜å‚¨safetensorsï¼Œé»˜è®¤ä¸ºTrue
- max_shard_size: å•å­˜å‚¨æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œé»˜è®¤'5GB'


## é›†æˆå‚æ•°

### è®­ç»ƒå‚æ•°
è®­ç»ƒå‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)ã€[Seq2SeqTrainerå‚æ•°](#Seq2SeqTrainerå‚æ•°)ã€[tunerå‚æ•°](#tunerå‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†:

- add_version: åœ¨output_dirä¸Šé¢å¤–å¢åŠ ç›®å½•`'<ç‰ˆæœ¬å·>-<æ—¶é—´æˆ³>'`é˜²æ­¢æƒé‡è¦†ç›–ï¼Œé»˜è®¤ä¸ºTrue
- resume_only_model: å¦‚æœresume_from_checkpointï¼Œä»…resumeæ¨¡å‹æƒé‡ï¼Œé»˜è®¤ä¸ºFalse
- check_model: æ£€æŸ¥æœ¬åœ°æ¨¡å‹æ–‡ä»¶æœ‰æŸåæˆ–ä¿®æ”¹å¹¶ç»™å‡ºæç¤ºï¼Œé»˜è®¤ä¸ºTrueã€‚å¦‚æœæ˜¯æ–­ç½‘ç¯å¢ƒï¼Œè¯·è®¾ç½®ä¸ºFalse
- loss_type: lossç±»å‹ï¼Œé»˜è®¤ä½¿ç”¨æ¨¡å‹è‡ªå¸¦æŸå¤±å‡½æ•°

- packing: æ˜¯å¦ä½¿ç”¨packingï¼Œé»˜è®¤ä¸ºFalse
- ğŸ”¥lazy_tokenize: æ˜¯å¦ä½¿ç”¨lazy_tokenizeï¼Œåœ¨LLMè®­ç»ƒä¸­é»˜è®¤Falseï¼ŒMLLMè®­ç»ƒä¸­é»˜è®¤True

- acc_strategy: è®­ç»ƒaccçš„ç­–ç•¥ï¼Œå¯ä»¥ä¸º`seq`å’Œ`token`çº§åˆ«çš„accï¼Œé»˜è®¤ä¸º`token`
- max_new_tokens: predict_with_generate=Trueæ—¶çš„æœ€å¤§ç”Ÿæˆtokenæ•°é‡ï¼Œé»˜è®¤64
- temperature: predict_with_generate=Trueæ—¶çš„temperatureï¼Œé»˜è®¤0
- optimizer: pluginçš„è‡ªå®šä¹‰optimizeråç§°
- metric: pluginçš„è‡ªå®šä¹‰metricåç§°

### RLHFå‚æ•°
RLHFå‚æ•°ç»§æ‰¿äº[è®­ç»ƒå‚æ•°](#è®­ç»ƒå‚æ•°)

- ğŸ”¥rlhf_type: å¯¹é½ç®—æ³•ç±»å‹ï¼Œæ”¯æŒ`dpo`, `orpo`, `simpo`, `kto`, `cpo`, `rm`, `ppo`
- ref_model: DPOç­‰ç®—æ³•ä¸­çš„åŸå§‹å¯¹æ¯”æ¨¡å‹
- ref_model_type: åŒmodel_type
- ref_model_revision: åŒmodel_revision

- ğŸ”¥beta: KLæ­£åˆ™é¡¹ç³»æ•°, é»˜è®¤ä¸º`None`, å³`simpo`ç®—æ³•é»˜è®¤ä¸º`2.`, å…¶ä»–ç®—æ³•é»˜è®¤ä¸º`0.1`. å…·ä½“å‚è€ƒ[æ–‡æ¡£](./äººç±»å¯¹é½.md)
- label_smoothing: æ˜¯å¦ä½¿ç”¨DPO smoothing, é»˜è®¤å€¼ä¸º`0`ï¼Œä¸€èˆ¬è®¾ç½®åœ¨0~0.5ä¹‹é—´

- ğŸ”¥rpo_alpha: æ§åˆ¶DPOä¸­åŠ å…¥sft_lossçš„æƒé‡, é»˜è®¤ä¸º`1`. æœ€åçš„lossä¸º`KL_loss + rpo_alpha * sft_loss`

- cpo_alpha: CPO/SimPO loss ä¸­ nll lossçš„ç³»æ•°, é»˜è®¤ä¸º`1.`

- simpo_gamma: SimPOç®—æ³•ä¸­çš„reward marginé¡¹ï¼Œè®ºæ–‡ä¸­å»ºè®®è®¾ç½®ä¸º0.5-1.5, é»˜è®¤ä¸º`1.`

- desirable_weight: KTOç®—æ³•ä¸­å¯¹desirable responseçš„lossæƒé‡ $\lambda_D$ ï¼Œé»˜è®¤ä¸º`1.`
- undesirable_weight: KTOè®ºæ–‡ä¸­å¯¹undesirable responseçš„lossæƒé‡ $\lambda_U$ , é»˜è®¤ä¸º`1.`

#### PPOå‚æ•°
- reward_model: é»˜è®¤ä¸ºNone
- reward_adapters: é»˜è®¤ä¸º`[]`
- reward_model_type: é»˜è®¤ä¸ºNone
- reward_model_revision: é»˜è®¤ä¸ºNone

ä»¥ä¸‹å‚æ•°å«ä¹‰å¯ä»¥å‚è€ƒ[è¿™é‡Œ](https://huggingface.co/docs/trl/main/ppo_trainer)
- num_ppo_epochs: é»˜è®¤ä¸º4
- whiten_rewards: é»˜è®¤ä¸ºFalse
- kl_coef: é»˜è®¤ä¸º0.05
- cliprange: é»˜è®¤ä¸º0.2
- vf_coef: é»˜è®¤ä¸º0.1
- cliprange_value: é»˜è®¤ä¸º0.2
- gamma: é»˜è®¤ä¸º1.0
- lam: é»˜è®¤ä¸º0.95
- num_mini_batches: é»˜è®¤ä¸º1
- local_rollout_forward_batch_size: é»˜è®¤ä¸º64
- num_sample_generations: é»˜è®¤ä¸º10
- response_length: é»˜è®¤ä¸º512
- temperature: é»˜è®¤ä¸º0.7
- missing_eos_penalty: é»˜è®¤ä¸ºNone

### æ¨ç†å‚æ•°

æ¨ç†å‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)ã€[åˆå¹¶å‚æ•°](#åˆå¹¶å‚æ•°)ã€[vLLMå‚æ•°](#vllmå‚æ•°)ã€[LMDeployå‚æ•°](#LMDeployå‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†ï¼š

- ğŸ”¥infer_backend: æ¨ç†backendï¼Œæ”¯æŒ'pt'ã€'vllm'ã€'lmdeploy'ä¸‰ä¸ªæ¨ç†æ¡†æ¶ï¼Œé»˜è®¤ä¸º'pt'
- ğŸ”¥max_batch_size: pt backendçš„batch_sizeï¼Œé»˜è®¤ä¸º1
- ddp_backend: pt backendä½¿ç”¨å¤šå¡æ¨ç†æ—¶çš„åˆ†å¸ƒå¼åç«¯ï¼Œé»˜è®¤ä¸ºNone. å¤šå¡æ¨ç†ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/infer/pt)
- result_path: æ¨ç†ç»“æœå­˜å‚¨è·¯å¾„ï¼ˆjsonlï¼‰ï¼Œé»˜è®¤ä¸ºNoneï¼Œä¿å­˜åœ¨checkpointç›®å½•æˆ–è€…'./result'ç›®å½•
- val_dataset_sample: æ¨ç†æ•°æ®é›†é‡‡æ ·æ•°ï¼Œé»˜è®¤ä¸ºNone


### éƒ¨ç½²å‚æ•°

éƒ¨ç½²å‚æ•°ç»§æ‰¿äº[æ¨ç†å‚æ•°](#æ¨ç†å‚æ•°)

- host: æœåŠ¡hostï¼Œé»˜è®¤ä¸º'0.0.0.0'
- port: ç«¯å£å·ï¼Œé»˜è®¤ä¸º8000
- api_key: è®¿é—®éœ€è¦ä½¿ç”¨çš„Key

- owned_by: é»˜è®¤ä¸º`swift`
- ğŸ”¥served_model_name: æä¾›æœåŠ¡çš„æ¨¡å‹åç§°ï¼Œé»˜è®¤ä½¿ç”¨modelçš„åç¼€
- verbose: æ‰“å°è®¿é—®æ—¥å¿—ï¼Œé»˜è®¤ä¸ºTrue
- log_interval: tokens/sç»Ÿè®¡å€¼æ‰“å°é—´éš”ï¼Œé»˜è®¤20ç§’ã€‚è®¾ç½®ä¸º-1åˆ™ä¸æ‰“å°
- max_logprobs: æœ€å¤šè¿”å›çš„logprobsæ•°é‡ï¼Œé»˜è®¤ä¸º20


### Web-UIå‚æ•°
- server_name: web-uiçš„hostï¼Œé»˜è®¤ä¸º'0.0.0.0'
- server_port: web-uiçš„portï¼Œé»˜è®¤ä¸º7860
- share: é»˜è®¤ä¸ºFalse
- lang: web-uiçš„è¯­è¨€ï¼Œå¯é€‰ä¸º'zh', 'en'ã€‚é»˜è®¤ä¸º'zh'


### Appå‚æ•°

Appå‚æ•°ç»§æ‰¿äº[éƒ¨ç½²å‚æ•°](#éƒ¨ç½²å‚æ•°), [Web-UIå‚æ•°](#Web-UIå‚æ•°)
- base_url: æ¨¡å‹éƒ¨ç½²çš„base_urlï¼Œä¾‹å¦‚`http://localhost:8000/v1`ã€‚é»˜è®¤ä¸º`None`
- studio_title: studioçš„æ ‡é¢˜ã€‚é»˜è®¤ä¸ºNoneï¼Œè®¾ç½®ä¸ºæ¨¡å‹å
- is_multimodal: æ˜¯å¦å¯åŠ¨å¤šæ¨¡æ€ç‰ˆæœ¬çš„appã€‚é»˜è®¤ä¸ºNoneï¼Œè‡ªåŠ¨æ ¹æ®modelåˆ¤æ–­ï¼Œè‹¥æ— æ³•åˆ¤æ–­ï¼Œè®¾ç½®ä¸ºFalse
- lang: è¦†ç›–Web-UIå‚æ•°ï¼Œé»˜è®¤ä¸º'en'

### è¯„æµ‹å‚æ•°

è¯„æµ‹å‚æ•°ç»§æ‰¿äº[éƒ¨ç½²å‚æ•°](#éƒ¨ç½²å‚æ•°)

- ğŸ”¥eval_dataset: è¯„æµ‹æ•°æ®é›†ï¼Œè¯·æŸ¥çœ‹[è¯„æµ‹æ–‡æ¡£](./è¯„æµ‹.md)
- eval_limit: æ¯ä¸ªè¯„æµ‹é›†çš„é‡‡æ ·æ•°ï¼Œé»˜è®¤ä¸ºNone
- eval_output_dir: è¯„æµ‹å­˜å‚¨ç»“æœçš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º'eval_output'
- temperature: é»˜è®¤ä¸º0.
- verbose: è¯¥å‚æ•°åœ¨æœ¬åœ°è¯„ä¼°æ—¶ä¼ å…¥DeployArgumentsä¸­ï¼Œé»˜è®¤`False`
- eval_num_proc: è¯„æµ‹æ—¶å®¢æˆ·ç«¯æœ€å¤§å¹¶å‘æ•°ï¼Œæ–‡æœ¬è¯„æµ‹é»˜è®¤256ï¼Œå¤šæ¨¡æ€é»˜è®¤16
- ğŸ”¥eval_url: è¯„æµ‹urlï¼Œä¾‹å¦‚`http://localhost:8000/v1`ã€‚é»˜è®¤ä¸ºNoneï¼Œé‡‡ç”¨æœ¬åœ°éƒ¨ç½²è¯„ä¼°ã€‚ä¾‹å­å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/modelscope/ms-swift/tree/main/examples/eval/eval_url)

### å¯¼å‡ºå‚æ•°

å¯¼å‡ºå‚æ•°é™¤åŒ…å«[åŸºæœ¬å‚æ•°](#åŸºæœ¬å‚æ•°)å’Œ[åˆå¹¶å‚æ•°](#åˆå¹¶å‚æ•°)å¤–ï¼Œè¿˜åŒ…å«ä¸‹é¢çš„éƒ¨åˆ†:

- ğŸ”¥output_dir: å¯¼å‡ºç»“æœå­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤ä¸ºNone

- ğŸ”¥quant_method: å¯é€‰ä¸º'gptq', 'awq'ï¼Œé»˜è®¤ä¸ºNone
- quant_n_samples: gptq/awqçš„æ ¡éªŒé›†æŠ½æ ·æ•°ï¼Œé»˜è®¤ä¸º128
- max_length: æ ¡å‡†é›†çš„max_length, é»˜è®¤å€¼2048
- quant_batch_size: é‡åŒ–batch_sizeï¼Œé»˜è®¤ä¸º1
- group_size: é‡åŒ–groupå¤§å°ï¼Œé»˜è®¤ä¸º128

- ğŸ”¥push_to_hub: æ˜¯å¦æ¨é€hubï¼Œé»˜è®¤ä¸ºFalse
- hub_model_id: æ¨é€çš„model_idï¼Œé»˜è®¤ä¸ºNone
- hub_private_repo: æ˜¯å¦æ˜¯private repoï¼Œé»˜è®¤ä¸ºFalse
- commit_message: æäº¤ä¿¡æ¯ï¼Œé»˜è®¤ä¸º'update files'


## ç‰¹å®šæ¨¡å‹å‚æ•°
ç‰¹å®šæ¨¡å‹å‚æ•°å¯ä»¥é€šè¿‡`--model_kwargs`æˆ–è€…ç¯å¢ƒå˜é‡è¿›è¡Œè®¾ç½®ï¼Œä¾‹å¦‚: `--model_kwargs '{"fps_max_frames": 12}'`æˆ–è€…`FPS_MAX_FRAMES=12`

### qwen2_vl, qvq
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://github.com/QwenLM/Qwen2-VL/blob/main/qwen-vl-utils/src/qwen_vl_utils/vision_process.py#L24)

- IMAGE_FACTOR: é»˜è®¤ä¸º28
- MIN_PIXELS: é»˜è®¤ä¸º`4 * 28 * 28`
- ğŸ”¥MAX_PIXELS: é»˜è®¤ä¸º`16384 * 28 * 28`ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/ocr.sh#L3)
- MAX_RATIO: é»˜è®¤ä¸º200
- VIDEO_MIN_PIXELS: é»˜è®¤ä¸º`128 * 28 * 28`
- ğŸ”¥VIDEO_MAX_PIXELS: é»˜è®¤ä¸º`768 * 28 * 28`ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/video.sh#L7)
- VIDEO_TOTAL_PIXELS: é»˜è®¤ä¸º`24576 * 28 * 28`
- FRAME_FACTOR: é»˜è®¤ä¸º2
- FPS: é»˜è®¤ä¸º2.0
- FPS_MIN_FRAMES: é»˜è®¤ä¸º4
- ğŸ”¥FPS_MAX_FRAMES: é»˜è®¤ä¸º768ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/modelscope/ms-swift/blob/main/examples/train/multimodal/video.sh#L8)

### internvl, internvl_phi3
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/models/OpenGVLab/Mini-InternVL-Chat-2B-V1-5)
- MAX_NUM: é»˜è®¤ä¸º12
- INPUT_SIZE: é»˜è®¤ä¸º448

### internvl2, internvl2_phi3, internvl2_5
å‚æ•°å«ä¹‰å¯ä»¥æŸ¥çœ‹[è¿™é‡Œ](https://modelscope.cn/models/OpenGVLab/InternVL2_5-2B)
- MAX_NUM: é»˜è®¤ä¸º12
- INPUT_SIZE: é»˜è®¤ä¸º448
- VIDEO_MAX_NUM: é»˜è®¤ä¸º1ã€‚è§†é¢‘çš„MAX_NUM
- VIDEO_SEGMENTS: é»˜è®¤ä¸º8


### minicpmv2_6
- MAX_SLICE_NUMS: é»˜è®¤ä¸º9ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6/file/view/master?fileName=config.json&status=1)
- VIDEO_MAX_SLICE_NUMS: é»˜è®¤ä¸º1ï¼Œè§†é¢‘çš„MAX_SLICE_NUMSï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6)
- MAX_NUM_FRAMES: é»˜è®¤ä¸º64ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/OpenBMB/MiniCPM-V-2_6)

### ovis1_6
- MAX_PARTITION: å‚è€ƒ[è¿™é‡Œ](https://github.com/AIDC-AI/Ovis/blob/d248e34d755a95d24315c40e2489750a869c5dbc/ovis/model/modeling_ovis.py#L312)

### mplug_owl3, mplug_owl3_241101
- MAX_NUM_FRAMES: é»˜è®¤ä¸º16ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/iic/mPLUG-Owl3-7B-240728)

### xcomposer2_4khd
- HD_NUM: é»˜è®¤ä¸º55ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/Shanghai_AI_Laboratory/internlm-xcomposer2-4khd-7b)

### xcomposer2_5
- HD_NUM: å›¾ç‰‡æ•°é‡ä¸º1æ—¶ï¼Œé»˜è®¤å€¼ä¸º24ã€‚å¤§äº1ï¼Œé»˜è®¤ä¸º6ã€‚å‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/AI-ModelScope/internlm-xcomposer2d5-7b/file/view/master?fileName=modeling_internlm_xcomposer2.py&status=1#L254)

### video_cogvlm2
- NUM_FRAMES: é»˜è®¤ä¸º24ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/THUDM/CogVLM2/blob/main/video_demo/inference.py#L22)

### phi3_vision
- NUM_CROPS: é»˜è®¤ä¸º4ï¼Œå‚è€ƒ[è¿™é‡Œ](https://modelscope.cn/models/LLM-Research/Phi-3.5-vision-instruct)

### llama3_1_omni
- N_MELS: é»˜è®¤ä¸º128ï¼Œå‚è€ƒ[è¿™é‡Œ](https://github.com/ictnlp/LLaMA-Omni/blob/544d0ff3de8817fdcbc5192941a11cf4a72cbf2b/omni_speech/infer/infer.py#L57)

### video_llava
- NUM_FRAMES: é»˜è®¤ä¸º16
