{
    "_description": "FSDP2 configuration similar to DeepSpeed ZeRO3-Offload (full shard with CPU offload)",
    "_note": "FULL_SHARD with CPU offload for parameters, gradients and optimizer states",
    "_requires": "torch>=2.4.0 for FSDP2",
    "_memory": "Lowest GPU memory, uses CPU RAM extensively",

    "fsdp": "full_shard auto_wrap offload",
    "fsdp_config": {
        "fsdp_version": 2,
        "auto_wrap_policy": "TRANSFORMER_BASED_WRAP",
        "cpu_ram_efficient_loading": true,
        "state_dict_type": "SHARDED_STATE_DICT",
        "limit_all_gathers": true,
        "backward_prefetch": "BACKWARD_PRE",
        "forward_prefetch": true
    }
}
