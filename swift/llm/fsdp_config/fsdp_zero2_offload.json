{
    "_description": "FSDP2 configuration similar to DeepSpeed ZeRO2-Offload (shard gradients + optimizer with CPU offload)",
    "_note": "SHARD_GRAD_OP with CPU offload for optimizer states",
    "_requires": "torch>=2.4.0 for FSDP2",
    "_memory": "Low GPU memory, uses CPU RAM for optimizer states",

    "fsdp": "shard_grad_op auto_wrap offload",
    "fsdp_config": {
        "fsdp_version": 2,
        "auto_wrap_policy": "TRANSFORMER_BASED_WRAP",
        "cpu_ram_efficient_loading": true,
        "state_dict_type": "SHARDED_STATE_DICT",
        "limit_all_gathers": true,
        "backward_prefetch": "BACKWARD_PRE"
    }
}
